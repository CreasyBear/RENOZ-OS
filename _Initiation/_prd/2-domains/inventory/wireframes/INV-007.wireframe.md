# Wireframe: DOM-INV-007 - Inventory Aging Report

## Story Reference

- **Story ID**: DOM-INV-007
- **Name**: Inventory Aging Report
- **PRD**: memory-bank/prd/domains/inventory.prd.json
- **Type**: Full Feature
- **Component Types**: Aging Report Page, Aging Buckets, Slow-Moving Highlights, Actions (Clearance/Write-off)
- **Primary Users**: Finance, Operations Manager, Business Owner, Warehouse Manager

## Overview

Track age of inventory for slow-moving items. Calculate days since receipt, display aging buckets (0-30, 31-60, 61-90, 90+ days), highlight slow-moving inventory, and provide actions for clearance marking and write-offs. Export aging report to CSV.

## UI Patterns (Reference Implementation)

### Card Grid with Metrics
- **Pattern**: RE-UI Card
- **Reference**: `_reference/.reui-reference/registry/default/ui/card.tsx`
- **Features**:
  - Aging bucket cards (0-30, 31-60, 61-90, 90+ days)
  - Color-coded by age (green fresh, yellow, orange, red old)
  - Value and item count per bucket

### Segmented Progress Bar
- **Pattern**: Custom component using RE-UI Progress
- **Reference**: `_reference/.reui-reference/registry/default/ui/progress.tsx`
- **Features**:
  - Distribution bar showing aging percentages
  - Segmented by bucket with colors
  - Percentage labels per segment

### Data Table with Action Menu
- **Pattern**: RE-UI DataTable + DropdownMenu
- **Reference**: `_reference/.reui-reference/registry/default/ui/data-table.tsx` & `dropdown-menu.tsx`
- **Features**:
  - Aging items table (product, age, qty, value, last movement)
  - Action dropdown (mark clearance, write-off, transfer)
  - Bulk selection with checkboxes

### Dialog with Confirmation
- **Pattern**: RE-UI AlertDialog
- **Reference**: `_reference/.reui-reference/registry/default/ui/alert-dialog.tsx`
- **Features**:
  - Write-off dialog with destructive action warning
  - Checkbox confirmation acknowledgment
  - Impact preview (quantity, value to write off)

### Select with Options
- **Pattern**: RE-UI Select
- **Reference**: `_reference/.reui-reference/registry/default/ui/select.tsx`
- **Features**:
  - Reason dropdown (obsolete, damaged, expired, lost)
  - Required field validation
  - Clearance percentage selector

---

## Mobile Wireframe (375px)

### Aging Report Overview

```
+=========================================+
| < Reports                        [...]  |
+-----------------------------------------+
| Inventory Aging                         |
+-----------------------------------------+
|                                         |
|  AS OF: January 10, 2026                |
|                                         |
|  +-------------------------------------+|
|  | AGING SUMMARY                       ||
|  | ===================================||
|  |                                     ||
|  | 0-30 Days     31-60 Days            ||
|  | $85,420       $32,150               ||
|  | 456 items     189 items             ||
|  |                                     ||
|  | 61-90 Days    90+ Days              ||
|  | $18,280       $7,000 [!]            ||
|  | 78 items      34 items              ||
|  |                                     ||
|  | Total Value: $142,850               ||
|  +-------------------------------------+|
|                                         |
|  AGING DISTRIBUTION                     |
|  +-------------------------------------+|
|  | [#########|####|##|#]               ||
|  |  60%      22%  13% 5%               ||
|  +-------------------------------------+|
|                                         |
|  [All Items] [Slow Moving] [90+ Days]   |
|              ============               |
|                                         |
|  SLOW-MOVING ITEMS (34)                 |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  | [!] Widget Pro 300                  ||
|  |     SKU: WP-300                     ||
|  |     Age: 145 days                   ||
|  |     Qty: 12 | Value: $1,200         ||
|  |     Last Movement: Sep 18           ||
|  |                                     ||
|  |     [Mark Clearance] [Write-off]    ||
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  | [!] Connector Old Model             ||
|  |     SKU: CN-OLD                     ||
|  |     Age: 128 days                   ||
|  |     Qty: 45 | Value: $675           ||
|  |     Last Movement: Oct 4            ||
|  |                                     ||
|  |     [Mark Clearance] [Write-off]    ||
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  | [*] Bracket Set v1                  ||
|  |     SKU: BS-V1                      ||
|  |     Age: 98 days                    ||
|  |     Qty: 28 | Value: $280           ||
|  |     Last Movement: Oct 14           ||
|  |                                     ||
|  |     [Mark Clearance] [Write-off]    ||
|  +-------------------------------------+|
|                                         |
|  [Export Report]                        |
|                                         |
+-----------------------------------------+
```

### Aging Item Detail

```
+=========================================+
| =====================================   |
|                                         |
|  ITEM AGING DETAIL               [X]    |
|  -------------------------------------- |
|                                         |
|  Widget Pro 300 (WP-300)                |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  | AGING STATUS                        ||
|  | ===================================||
|  |                                     ||
|  | Age: 145 days                       ||
|  | Aging Bucket: 90+ Days [!]          ||
|  |                                     ||
|  | Received: August 18, 2025           ||
|  | Last Movement: September 18, 2025   ||
|  | Days Since Movement: 114 days       ||
|  +-------------------------------------+|
|                                         |
|  STOCK DETAILS                          |
|  -----------------------------------    |
|                                         |
|  Quantity: 12 units                     |
|  Unit Cost: $100.00                     |
|  Total Value: $1,200.00                 |
|  Location: Aisle A-1, Shelf 3           |
|                                         |
|  MOVEMENT HISTORY                       |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  | Sep 18 - Sold (3 units)             ||
|  | Sep 5 - Sold (2 units)              ||
|  | Aug 28 - Sold (1 unit)              ||
|  | Aug 18 - Received (18 units)        ||
|  +-------------------------------------+|
|                                         |
|  AGING ANALYSIS                         |
|  -----------------------------------    |
|                                         |
|  This item is slow-moving.              |
|  Average: 0.04 units/day                |
|  At current rate: 300 days to sell      |
|                                         |
|  ACTIONS                                |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  |      [MARK FOR CLEARANCE]           || <- 56px
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  |         [WRITE-OFF]                 || <- Ghost style
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  |      [TRANSFER LOCATION]            || <- Ghost style
|  +-------------------------------------+|
|                                         |
+=========================================+
```

### Mark for Clearance Dialog

```
+=========================================+
| =====================================   |
|                                         |
|  MARK FOR CLEARANCE              [X]    |
|  -------------------------------------- |
|                                         |
|  Product                                |
|  +------------------------------------+ |
|  | Widget Pro 300 (WP-300)   [locked] | |
|  +------------------------------------+ |
|                                         |
|  Current Price: $100.00                 |
|  Current Stock: 12 units                |
|  Total Value: $1,200.00                 |
|                                         |
|  CLEARANCE PRICE *                      |
|  +------------------------------------+ |
|  | $ 65.00                            | | <- 35% off suggested
|  +------------------------------------+ |
|  Suggested: $65.00 (35% off)            |
|                                         |
|  CLEARANCE PERIOD                       |
|  +------------------------------------+ |
|  | [cal] Jan 10 - Feb 10, 2026        | |
|  +------------------------------------+ |
|  30 days default                        |
|                                         |
|  Notes                                  |
|  +------------------------------------+ |
|  | Slow-moving inventory clearance    | |
|  +------------------------------------+ |
|                                         |
|  IMPACT PREVIEW                         |
|  -----------------------------------    |
|                                         |
|  Original Value: $1,200.00              |
|  Clearance Value: $780.00               |
|  Potential Loss: $420.00 (-35%)         |
|                                         |
|  +------------------------------------+ |
|  |                                    | |
|  |    [MARK FOR CLEARANCE]            | | <- 56px primary
|  |                                    | |
|  +------------------------------------+ |
|                                         |
+=========================================+
```

### Write-off Dialog

```
+=========================================+
| =====================================   |
|                                         |
|  INVENTORY WRITE-OFF             [X]    |
|  -------------------------------------- |
|                                         |
|  [!] This action cannot be undone       |
|                                         |
|  Product                                |
|  +------------------------------------+ |
|  | Widget Pro 300 (WP-300)   [locked] | |
|  +------------------------------------+ |
|                                         |
|  QUANTITY TO WRITE OFF *                |
|  +------------------------------------+ |
|  |  12                                | | <- Default: all
|  +------------------------------------+ |
|  Available: 12 units                    |
|                                         |
|  WRITE-OFF VALUE                        |
|  Unit Cost: $100.00                     |
|  Total Write-off: $1,200.00             |
|                                         |
|  REASON *                               |
|  +--------------------------------+ [v] |
|  | Select reason...                   | |
|  +------------------------------------+ |
|                                         |
|  Reasons:                               |
|  - Obsolete                             |
|  - Damaged                              |
|  - Expired                              |
|  - Lost                                 |
|  - Other                                |
|                                         |
|  Notes *                                |
|  +------------------------------------+ |
|  | Discontinued product, no demand    | |
|  +------------------------------------+ |
|                                         |
|  [x] I understand this will remove      |
|      inventory and record a loss        |
|                                         |
|  +------------------------------------+ |
|  |                                    | |
|  |       [CONFIRM WRITE-OFF]          | | <- 56px destructive
|  |                                    | |
|  +------------------------------------+ |
|                                         |
+=========================================+
```

---

## Tablet Wireframe (768px)

### Aging Report Overview

```
+=======================================================================+
| Reports > Inventory Aging                                   [Export]  |
+-----------------------------------------------------------------------+
|                                                                       |
|  +-- AGING BUCKETS ------------------------------------------------------+
|  |                                                                       |
|  |  +-------------------+  +-------------------+  +-------------------+  +-------------------+
|  |  | 0-30 DAYS         |  | 31-60 DAYS        |  | 61-90 DAYS        |  | 90+ DAYS [!]     |
|  |  | $85,420           |  | $32,150           |  | $18,280           |  | $7,000           |
|  |  | 456 items (60%)   |  | 189 items (22%)   |  | 78 items (13%)    |  | 34 items (5%)    |
|  |  | Fresh stock       |  | Monitor           |  | Action needed     |  | Slow-moving      |
|  |  +-------------------+  +-------------------+  +-------------------+  +-------------------+
|  |                                                                       |
|  |  Distribution: [###############|#######|####|##]                     |
|  |                                                                       |
|  +-----------------------------------------------------------------------+
|                                                                       |
|  [All Items] [Slow-Moving] [90+ Days] [Clearance] [Write-off History]  |
|              ============                                              |
|                                                                       |
|  [Search_____________________] [Category v] [Location v] [Sort: Age v] |
|                                                                       |
|  +-------------------------------------------------------------------+|
|  | Product         | SKU    | Age   | Qty | Value    | Last Move | Act||
|  +-------------------------------------------------------------------+|
|  | Widget Pro 300  | WP-300 | 145d  | 12  | $1,200   | Sep 18    | [*]||
|  | Connector Old   | CN-OLD | 128d  | 45  | $675     | Oct 4     | [*]||
|  | Bracket Set v1  | BS-V1  | 98d   | 28  | $280     | Oct 14    | [*]||
|  | Cable Type A    | CT-A   | 95d   | 15  | $225     | Oct 17    | [*]||
|  | Mounting Old    | MO-01  | 92d   | 8   | $120     | Oct 20    | [*]||
|  +-------------------------------------------------------------------+|
|                                                                       |
|  Total Slow-Moving: $7,000 (34 items)  [Take Bulk Action v]           |
|                                                                       |
+=======================================================================+
```

### Aging Detail Modal

```
+=======================================================================+
| Widget Pro 300 (WP-300) - Aging Detail                           [X]  |
+=======================================================================+
|                                                                       |
|  +-- AGING STATUS --------------------+  +-- STOCK INFO -------------+|
|  |                                    |  |                           ||
|  |  Age: 145 days                     |  |  Quantity: 12 units       ||
|  |  Bucket: 90+ Days [!]              |  |  Unit Cost: $100.00       ||
|  |                                    |  |  Total Value: $1,200.00   ||
|  |  Received: Aug 18, 2025            |  |                           ||
|  |  Last Movement: Sep 18, 2025       |  |  Location:                ||
|  |  Days Since: 114 days              |  |  Aisle A-1, Shelf 3       ||
|  |                                    |  |                           ||
|  +------------------------------------+  +---------------------------+|
|                                                                       |
|  +-- MOVEMENT HISTORY -------------------+  +-- ANALYSIS ------------+|
|  |                                       |  |                        ||
|  |  Sep 18 - Sold (3 units)              |  |  Velocity: 0.04/day    ||
|  |  Sep 5 - Sold (2 units)               |  |  Days to Sell: 300     ||
|  |  Aug 28 - Sold (1 unit)               |  |                        ||
|  |  Aug 18 - Received (18 units)         |  |  Recommendation:       ||
|  |                                       |  |  Mark for clearance    ||
|  |  [View Full History]                  |  |  at 35% discount       ||
|  +---------------------------------------+  +------------------------+|
|                                                                       |
|  +-- ACTIONS ------------------------------------------------------------+
|  |                                                                       |
|  |  [Mark for Clearance]  [Write-off]  [Transfer Location]  [View Item] |
|  |                                                                       |
|  +-----------------------------------------------------------------------+
|                                                                       |
+=======================================================================+
```

---

## Desktop Wireframe (1280px+)

### Aging Report - Full

```
+======================================================================================================+
| Renoz CRM                                                                       [Bell] [User v]      |
+-------------+----------------------------------------------------------------------------------------+
|             |                                                                                        |
| Dashboard   |  Reports > Inventory Aging                                                             |
| Customers   |  ------------------------------------------------------------------------------------- |
| Orders      |                                                                                        |
| Products    |  +-- AGING SUMMARY --------------------------------------------------------------------+|
| Inventory   |  |                                                                                     |
| Reports <   |  |  +---------------------+  +---------------------+  +---------------------+  +-------+|
|   Aging     |  |  | 0-30 DAYS           |  | 31-60 DAYS          |  | 61-90 DAYS          |  | 90+   ||
|   ========  |  |  | $85,420             |  | $32,150             |  | $18,280             |  |$7,000 ||
|   Valuation |  |  | 456 items           |  | 189 items           |  | 78 items            |  |34 [!] ||
|   Reserved  |  |  | 60% of value        |  | 22% of value        |  | 13% of value        |  | 5%    ||
| Jobs        |  |  +---------------------+  +---------------------+  +---------------------+  +-------+|
| Pipeline    |  |                                                                                     |
|             |  |  DISTRIBUTION: [############################|#############|########|####]           |
|             |  |                 0-30 Days (60%)              31-60 (22%)   61-90 (13%) 90+ (5%)     |
|             |  |                                                                                     |
|             |  +-------------------------------------------------------------------------------------+|
|             |                                                                                        |
|             |  [All Items] [Slow-Moving] [90+ Days] [Clearance Items] [Write-off History]   [Export] |
|             |              ============                                                              |
|             |                                                                                        |
|             |  [Search___________________] [Category v] [Location v] [Age v] [Sort: Age desc v]      |
|             |                                                                                        |
|             |  +------------------------------------------------------------------------------------+|
|             |  |                                                                                    ||
|             |  | [ ] | Product         | SKU       | Age    | Qty | Value    | Last Move | Actions ||
|             |  | ------------------------------------------------------------------------------------||
|             |  | [ ] | Widget Pro 300  | WP-300    | 145d   | 12  | $1,200   | Sep 18    | [...]   ||
|             |  | [ ] | Connector Old   | CN-OLD    | 128d   | 45  | $675     | Oct 4     | [...]   ||
|             |  | [ ] | Bracket Set v1  | BS-V1     | 98d    | 28  | $280     | Oct 14    | [...]   ||
|             |  | [ ] | Cable Type A    | CT-A      | 95d    | 15  | $225     | Oct 17    | [...]   ||
|             |  | [ ] | Mounting Old    | MO-01     | 92d    | 8   | $120     | Oct 20    | [...]   ||
|             |  | [ ] | Adapter Legacy  | AD-LEG    | 91d    | 22  | $440     | Oct 21    | [...]   ||
|             |  |                                                                                    ||
|             |  +------------------------------------------------------------------------------------+|
|             |                                                                                        |
|             |  Selected: 0 items   Total Slow-Moving: $7,000 (34 items)   [Bulk Actions v]           |
|             |                                                                                        |
+-------------+----------------------------------------------------------------------------------------+
```

### Aging Detail Sidebar

```
+======================================================================================================+
|                                                                                                      |
|  +-- ITEMS TABLE (2/3 width) ----------------------------+  +-- ITEM DETAIL (1/3 width) ----------+|
|  |                                                       |  |                                      ||
|  | [ ] | Product         | SKU    | Age   | Value | Act  |  | WIDGET PRO 300 (WP-300)              ||
|  | --------------------------------------------------------  | ================================      ||
|  | [*] | Widget Pro 300  | WP-300 | 145d  | $1,200| [...] |  |                                      ||
|  | [ ] | Connector Old   | CN-OLD | 128d  | $675 | [...] |  | AGING STATUS                         ||
|  | [ ] | Bracket Set v1  | BS-V1  | 98d   | $280 | [...] |  | --------------------------------     ||
|  | [ ] | Cable Type A    | CT-A   | 95d   | $225 | [...] |  |                                      ||
|  |                                                       |  | Age: 145 days                        ||
|  |                                                       |  | Bucket: [!] 90+ Days                 ||
|  |                                                       |  |                                      ||
|  |                                                       |  | Received: Aug 18, 2025               ||
|  |                                                       |  | Last Movement: Sep 18, 2025          ||
|  |                                                       |  | Days Since Movement: 114             ||
|  |                                                       |  |                                      ||
|  |                                                       |  | STOCK                                ||
|  |                                                       |  | --------------------------------     ||
|  |                                                       |  |                                      ||
|  |                                                       |  | Quantity: 12 units                   ||
|  |                                                       |  | Unit Cost: $100.00                   ||
|  |                                                       |  | Total Value: $1,200.00               ||
|  |                                                       |  | Location: Aisle A-1, Shelf 3         ||
|  |                                                       |  |                                      ||
|  |                                                       |  | VELOCITY ANALYSIS                    ||
|  |                                                       |  | --------------------------------     ||
|  |                                                       |  |                                      ||
|  |                                                       |  | Daily Avg: 0.04 units                ||
|  |                                                       |  | Est. Days to Sell: 300 days          ||
|  |                                                       |  | Turnover Rate: 1.2x/year             ||
|  |                                                       |  |                                      ||
|  |                                                       |  | RECOMMENDATION                       ||
|  |                                                       |  | --------------------------------     ||
|  |                                                       |  |                                      ||
|  |                                                       |  | [!] Mark for clearance at 35%        ||
|  |                                                       |  | discount. Estimated recovery:        ||
|  |                                                       |  | $780 of $1,200 value.                ||
|  |                                                       |  |                                      ||
|  |                                                       |  | ACTIONS                              ||
|  |                                                       |  | --------------------------------     ||
|  |                                                       |  |                                      ||
|  |                                                       |  | [Mark for Clearance]                 ||
|  |                                                       |  | [Write-off Inventory]                ||
|  |                                                       |  | [Transfer to New Location]           ||
|  |                                                       |  | [View Movement History]              ||
|  |                                                       |  |                                      ||
|  +-------------------------------------------------------+  +--------------------------------------+|
|                                                                                                      |
+======================================================================================================+
```

### Bulk Actions Modal

```
+======================================================================================================+
|                                                                                                      |
|  +------------------------------------------------------------------------------------------------+  |
|  | BULK ACTION - 5 ITEMS SELECTED                                                            [X] |  |
|  +================================================================================================+  |
|  |                                                                                                |  |
|  |  ACTION TYPE                                                                                   |  |
|  |  +------------------+  +------------------+  +------------------+                              |  |
|  |  | (o) Clearance    |  | ( ) Write-off    |  | ( ) Transfer     |                              |  |
|  |  +------------------+  +------------------+  +------------------+                              |  |
|  |                                                                                                |  |
|  |  SELECTED ITEMS                                                                                |  |
|  |  +--------------------------------------------------------------------------------------------+|  |
|  |  |                                                                                            ||  |
|  |  | Product         | SKU       | Age    | Qty | Current Value | Clearance Value | Loss       ||  |
|  |  | --------------------------------------------------------------------------------------------||  |
|  |  | Widget Pro 300  | WP-300    | 145d   | 12  | $1,200        | $780 (35% off)  | -$420      ||  |
|  |  | Connector Old   | CN-OLD    | 128d   | 45  | $675          | $439 (35% off)  | -$236      ||  |
|  |  | Bracket Set v1  | BS-V1     | 98d    | 28  | $280          | $182 (35% off)  | -$98       ||  |
|  |  | Cable Type A    | CT-A      | 95d    | 15  | $225          | $146 (35% off)  | -$79       ||  |
|  |  | Mounting Old    | MO-01     | 92d    | 8   | $120          | $78 (35% off)   | -$42       ||  |
|  |  |                                                                                            ||  |
|  |  +--------------------------------------------------------------------------------------------+|  |
|  |                                                                                                |  |
|  |  SUMMARY                                                                                       |  |
|  |  +------------------------------------------------------------------------------------------+ |  |
|  |  |                                                                                          | |  |
|  |  |  Total Items: 5 (108 units)                                                              | |  |
|  |  |  Current Value: $2,500                                                                   | |  |
|  |  |  Clearance Value: $1,625                                                                 | |  |
|  |  |  Estimated Loss: $875 (35%)                                                              | |  |
|  |  |                                                                                          | |  |
|  |  +------------------------------------------------------------------------------------------+ |  |
|  |                                                                                                |  |
|  |  CLEARANCE SETTINGS                                                                            |  |
|  |  +----------------------------------+  +----------------------------------+                    |  |
|  |  | Discount %: [35       ]          |  | Period: [30 days     ]           |                    |  |
|  |  +----------------------------------+  +----------------------------------+                    |  |
|  |                                                                                                |  |
|  +------------------------------------------------------------------------------------------------+  |
|  |                                                                                                |  |
|  |                                                   ( Cancel )   [ Apply to 5 Items ]            |  |
|  +------------------------------------------------------------------------------------------------+  |
|                                                                                                      |
+======================================================================================================+
```

---

## Interaction States

### Loading States

```
AGING REPORT LOADING:
+------------------------------------------------------------------------------------+
| 0-30 DAYS        | 31-60 DAYS       | 61-90 DAYS       | 90+ DAYS                  |
+------------------------------------------------------------------------------------+
| [..............] | [..............] | [..............] | [..............] |
+------------------------------------------------------------------------------------+

Product         | SKU    | Age   | Qty | Value    | Last Move | Actions
+------------------------------------------------------------------------------------+
[.............] | [.....] | [...] | [..] | [.......] | [.......] | [.....] |
[.............] | [.....] | [...] | [..] | [.......] | [.......] | [.....] |
+------------------------------------------------------------------------------------+
â†‘ Skeleton with shimmer

CALCULATING AGING:
+----------------------------------------+
|                                        |
|   Calculating aging data...            |
|   +--------------------------------+   |
|   | [==================          ] |   |
|   +--------------------------------+   |
|                                        |
|   Analyzing 1,247 items...             |
|                                        |
+----------------------------------------+
```

### Empty States

```
NO SLOW-MOVING ITEMS:
+----------------------------------------+
|                                        |
|           +-------------+              |
|           |   [check]   |              |
|           +-------------+              |
|                                        |
|    No Slow-Moving Inventory            |
|                                        |
|    All inventory is turning over       |
|    within acceptable timeframes.       |
|                                        |
|    Great inventory management!         |
|                                        |
+----------------------------------------+

NO ITEMS IN BUCKET:
+----------------------------------------+
|                                        |
|    No Items 90+ Days Old               |
|                                        |
|    All inventory has moved within      |
|    the last 90 days.                   |
|                                        |
|    [View 61-90 Day Items]              |
|                                        |
+----------------------------------------+

NO WRITE-OFF HISTORY:
+----------------------------------------+
|                                        |
|    No Write-off History                |
|                                        |
|    No inventory has been written       |
|    off in the selected period.         |
|                                        |
+----------------------------------------+
```

### Error States

```
AGING CALCULATION ERROR:
+----------------------------------------+
| [!] Aging Calculation Error            |
|                                        |
| Could not calculate aging for          |
| some items due to missing              |
| receipt dates.                         |
|                                        |
| [View Problem Items]  [Retry]          |
+----------------------------------------+

WRITE-OFF FAILED:
+----------------------------------------+
| [!] Write-off Failed                   |
|                                        |
| Could not complete write-off for       |
| Widget Pro 300.                        |
|                                        |
| Error: Insufficient permissions        |
|                                        |
| [Request Approval]  [Cancel]           |
+----------------------------------------+

EXPORT FAILED:
+----------------------------------------+
| [!] Export Failed                      |
|                                        |
| Could not generate aging report.       |
|                                        |
| [Try Again]  [Cancel]                  |
+----------------------------------------+
```

### Success States

```
MARKED FOR CLEARANCE:
+----------------------------------------+
| [ok] Marked for Clearance              |
|                                        |
| Widget Pro 300 marked for clearance    |
|                                        |
| Original Price: $100.00                |
| Clearance Price: $65.00                |
| Period: Jan 10 - Feb 10                |
|                                        |
| [View Item]  [Done]                    |
+----------------------------------------+

WRITE-OFF COMPLETE:
+----------------------------------------+
| [ok] Write-off Complete                |
|                                        |
| 12 units of Widget Pro 300             |
| written off.                           |
|                                        |
| Value: $1,200.00                       |
| Reason: Obsolete                       |
|                                        |
| [View Write-off Log]  [Done]           |
+----------------------------------------+

BULK ACTION COMPLETE:
+----------------------------------------+
| [ok] Bulk Action Complete              |
|                                        |
| 5 items marked for clearance           |
| Total: 108 units                       |
| Clearance value: $1,625                |
|                                        |
| [View Clearance Items]  [Done]         |
+----------------------------------------+

EXPORT COMPLETE:
+----------------------------------------+
| [ok] Report Exported                   |
|                                        |
| inventory-aging-2026-01-10.csv         |
| 757 items exported                     |
|                                        |
| [Open File]  [Done]                    |
+----------------------------------------+
```

---

## Accessibility Notes

### Focus Order

1. **Aging Report**
   - Tab to date selector
   - Tab to aging bucket cards (informational)
   - Tab to view tabs
   - Tab to search/filters
   - Tab through table headers (sortable)
   - Tab to row checkboxes
   - Tab to row actions
   - Tab to bulk actions button
   - Tab to export button

2. **Detail Sidebar**
   - Tab through action buttons
   - Tab to close button

3. **Action Dialogs**
   - Focus trapped in dialog
   - Tab through form fields
   - Tab to Cancel, then Confirm
   - Escape closes

### ARIA Requirements

```html
<!-- Aging Summary -->
<div role="region" aria-labelledby="aging-title">
  <h2 id="aging-title">Inventory Aging Report</h2>

  <div role="group" aria-label="Aging buckets">
    <div aria-label="0-30 days: $85,420, 456 items, 60% of inventory">
      <span class="label">0-30 Days</span>
      <span class="value">$85,420</span>
    </div>
    <div aria-label="90+ days: $7,000, 34 items, 5% of inventory, requires attention">
      <span class="label">90+ Days</span>
      <span class="value">$7,000</span>
      <span class="alert">[!]</span>
    </div>
  </div>
</div>

<!-- Aging Table -->
<table role="grid" aria-label="Slow-moving inventory items">
  <thead>
    <tr role="row">
      <th role="columnheader">
        <input type="checkbox" aria-label="Select all items" />
      </th>
      <th role="columnheader" aria-sort="descending">Age</th>
    </tr>
  </thead>
  <tbody>
    <tr role="row" aria-label="Widget Pro 300, 145 days old, 12 units, $1,200 value">
      <td role="gridcell">
        <input type="checkbox" aria-label="Select Widget Pro 300" />
      </td>
      <td role="gridcell">145 days</td>
    </tr>
  </tbody>
</table>

<!-- Write-off Dialog -->
<div
  role="alertdialog"
  aria-modal="true"
  aria-labelledby="writeoff-title"
  aria-describedby="writeoff-warning"
>
  <h2 id="writeoff-title">Inventory Write-off</h2>
  <p id="writeoff-warning">
    Warning: This action cannot be undone.
    12 units valued at $1,200 will be removed.
  </p>
</div>

<!-- Clearance Badge -->
<span
  role="status"
  aria-label="Marked for clearance at 35% discount"
  class="clearance-badge"
>
  Clearance -35%
</span>
```

### Screen Reader Announcements

- Report loaded: "Inventory aging report loaded, 34 items over 90 days old"
- Bucket selected: "Viewing 90+ days items, 34 items totaling $7,000"
- Item selected: "Widget Pro 300 selected, 145 days old, $1,200 value"
- Clearance applied: "Widget Pro 300 marked for clearance at 35% discount"
- Write-off complete: "12 units written off, $1,200 value removed"
- Export started: "Exporting aging report"

---

## Animation Choreography

### Aging Buckets

```
PAGE LOAD:
- Duration: 400ms total
- Stagger: 100ms between buckets
- Transform: translateY(20px) -> translateY(0)
- Opacity: 0 -> 1

DISTRIBUTION BAR:
- Duration: 600ms
- Width: 0% -> actual%
- Stagger: left to right
- Easing: ease-out
```

### Table Rows

```
LOAD:
- Duration: 300ms
- Stagger: 50ms between rows
- Transform: translateX(-10px) -> translateX(0)
- Opacity: 0 -> 1

AGE WARNING PULSE:
- Duration: 2s
- 90+ day items: subtle pulse on age badge
- Loop: 2 times on load
```

### Actions

```
CHECKBOX SELECT:
- Duration: 150ms
- Scale: 0.9 -> 1.1 -> 1
- Row: subtle highlight

CLEARANCE APPLIED:
- Duration: 400ms
- Row: green flash
- Badge: slide in from right
- Value: animate to clearance price

WRITE-OFF:
- Duration: 500ms
- Row: fade to gray
- Strikethrough animation on text
- Slide out after 500ms delay
```

### Detail Sidebar

```
OPEN:
- Duration: 300ms
- Slide in from right
- Opacity: 0 -> 1

UPDATE:
- Duration: 200ms
- Content: crossfade
```

---

## Component Props Interfaces

```typescript
// Aging Report
interface InventoryAgingReportProps {
  /** As-of date for aging calculation */
  asOfDate?: Date;
  /** Initial view */
  initialView?: 'all' | 'slow_moving' | '90_plus' | 'clearance' | 'writeoff_history';
  /** Age threshold for slow-moving (default 90) */
  slowMovingDays?: number;
  /** Callback when item selected */
  onItemSelect?: (itemId: string) => void;
}

interface AgingSummary {
  bucket0_30: AgingBucket;
  bucket31_60: AgingBucket;
  bucket61_90: AgingBucket;
  bucket90Plus: AgingBucket;
  totalValue: number;
  totalItems: number;
}

interface AgingBucket {
  label: string;
  minDays: number;
  maxDays?: number;
  itemCount: number;
  totalValue: number;
  percentageOfTotal: number;
}

interface AgingItem {
  id: string;
  productId: string;
  productName: string;
  sku: string;
  ageInDays: number;
  agingBucket: '0-30' | '31-60' | '61-90' | '90+';
  quantity: number;
  unitCost: number;
  totalValue: number;
  receivedAt: Date;
  lastMovementAt?: Date;
  daysSinceMovement?: number;
  locationId?: string;
  locationName?: string;
  isClearance?: boolean;
  clearancePrice?: number;
  velocity?: number; // units per day
  daysToSell?: number;
}

// Aging Detail
interface AgingItemDetailProps {
  /** Item data */
  item: AgingItem;
  /** Show inline actions */
  showActions?: boolean;
  /** Callback when action taken */
  onAction?: (action: 'clearance' | 'writeoff' | 'transfer' | 'view') => void;
}

interface AgingAnalysis {
  dailyVelocity: number;
  estimatedDaysToSell: number;
  turnoverRate: number;
  recommendation: 'clearance' | 'writeoff' | 'monitor' | 'ok';
  suggestedDiscountPercent?: number;
  estimatedRecovery?: number;
}

// Mark for Clearance Dialog
interface MarkClearanceDialogProps {
  /** Open state */
  open: boolean;
  /** Callback to close */
  onClose: () => void;
  /** Item(s) to mark */
  items: AgingItem[];
  /** Callback on success */
  onSuccess?: (clearanceItems: ClearanceItem[]) => void;
}

interface ClearanceFormValues {
  discountPercent: number;
  clearancePrice?: number; // alternative to percent
  startDate: Date;
  endDate: Date;
  notes?: string;
}

interface ClearanceItem {
  itemId: string;
  originalPrice: number;
  clearancePrice: number;
  discountPercent: number;
  startDate: Date;
  endDate: Date;
}

// Write-off Dialog
interface WriteOffDialogProps {
  /** Open state */
  open: boolean;
  /** Callback to close */
  onClose: () => void;
  /** Item(s) to write off */
  items: AgingItem[];
  /** Callback on success */
  onSuccess?: (writeOffs: WriteOff[]) => void;
}

interface WriteOffFormValues {
  quantity: number;
  reason: 'obsolete' | 'damaged' | 'expired' | 'lost' | 'other';
  notes: string;
  confirmAcknowledgment: boolean;
}

interface WriteOff {
  id: string;
  itemId: string;
  productId: string;
  productName: string;
  quantity: number;
  unitCost: number;
  totalValue: number;
  reason: string;
  notes: string;
  writtenOffAt: Date;
  writtenOffBy: string;
}

// Bulk Actions
interface BulkActionsProps {
  /** Selected items */
  selectedItems: AgingItem[];
  /** Callback when action selected */
  onAction: (action: 'clearance' | 'writeoff' | 'transfer', items: AgingItem[]) => void;
}

// Export
interface AgingExportProps {
  /** Export format */
  format?: 'csv' | 'pdf' | 'excel';
  /** Include columns */
  columns?: string[];
  /** Filter by bucket */
  bucketFilter?: string[];
  /** Callback on complete */
  onComplete?: (filename: string) => void;
}
```

---

## Component Files

| File | Purpose |
|------|---------|
| `src/routes/_authed/reports/inventory-aging.tsx` | Aging report page |
| `src/components/domain/inventory/aging-buckets.tsx` | Bucket summary cards |
| `src/components/domain/inventory/aging-table.tsx` | Aging items table |
| `src/components/domain/inventory/aging-item-detail.tsx` | Item detail sidebar |
| `src/components/domain/inventory/mark-clearance-dialog.tsx` | Clearance action |
| `src/components/domain/inventory/write-off-dialog.tsx` | Write-off action |
| `src/components/domain/inventory/aging-export.tsx` | Export functionality |

---

## Design References

- **Bucket Colors**: 0-30 green, 31-60 yellow, 61-90 orange, 90+ red
- **Distribution Bar**: Segmented horizontal bar with color gradients
- **Slow-Moving Badge**: Red pill with warning icon
- **Clearance Badge**: Purple pill with discount percentage
- **Write-off Style**: Gray strikethrough, muted colors
- **Action Buttons**: Clear CTAs with confirmations for destructive actions
