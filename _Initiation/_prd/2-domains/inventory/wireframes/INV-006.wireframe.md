# Wireframe: DOM-INV-006 - Inventory Forecasting

## Story Reference

- **Story ID**: DOM-INV-006
- **Name**: Inventory Forecasting
- **PRD**: memory-bank/prd/domains/inventory.prd.json
- **Type**: Full Feature
- **Component Types**: Forecast Page, Forecast Chart, Stockout Predictions, Reorder Recommendations
- **Primary Users**: Operations Manager, Purchasing, Business Owner

## Overview

Predict stock needs based on usage history. Calculate average daily/weekly usage, predict stockout dates, recommend reorder quantities based on lead time, and visualize projected stock levels. Factor in open POs and expected receipts.

## UI Patterns (Reference Implementation)

### Card with Alert Status
- **Pattern**: RE-UI Card + Alert
- **Reference**: `_reference/.reui-reference/registry/default/ui/card.tsx` & `alert.tsx`
- **Features**:
  - Forecast summary cards with stockout risk counts
  - Color-coded risk levels (red critical, orange warning)
  - Action buttons for quick PO creation

### Chart with Projection
- **Pattern**: Custom line chart using RE-UI Card
- **Reference**: `_reference/.reui-reference/registry/default/ui/card.tsx`
- **Features**:
  - Stock projection chart with current/projected lines
  - Dashed projection line vs solid current
  - Stockout date marker with vertical line
  - PO arrival indicators (green step)

### Data Table with Risk Badges
- **Pattern**: RE-UI DataTable + Badge
- **Reference**: `_reference/.reui-reference/registry/default/ui/data-table.tsx` & `badge.tsx`
- **Features**:
  - Product forecast table with days until stockout
  - Risk level badges ([!] critical, [*] warning)
  - Sortable by days remaining

### Tabs for View Switching
- **Pattern**: RE-UI Tabs
- **Reference**: `_reference/.reui-reference/registry/default/ui/tabs.tsx`
- **Features**:
  - View tabs (At Risk, All Products, Reorder Suggestions, Expected Receipts)
  - Active tab highlighting
  - Count badges on tabs

### Dialog with Recommendation
- **Pattern**: RE-UI Dialog + Alert
- **Reference**: `_reference/.reui-reference/registry/default/ui/dialog.tsx` & `alert.tsx`
- **Features**:
  - Recommendation cards with suggested actions
  - Priority indicators (urgent, high, medium)
  - Quick action buttons (expedite, create PO)

---

## Mobile Wireframe (375px)

### Forecast Overview

```
+=========================================+
| < Inventory                      [...]  |
+-----------------------------------------+
| Stock Forecasting                       |
+-----------------------------------------+
|                                         |
|  +-------------------------------------+|
|  | FORECAST SUMMARY                    ||
|  | ===================================||
|  |                                     ||
|  | Stockout Risks         Reorder Now  ||
|  |      [!] 3                 5        ||
|  |                                     ||
|  | Next 30 Days           Open POs     ||
|  |      12 items              8        ||
|  |                                     ||
|  +-------------------------------------+|
|                                         |
|  [At Risk] [All Products] [Reorder Now] |
|  ========                               |
|                                         |
|  STOCKOUT RISK - NEXT 14 DAYS           |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  | [!] 10kWh LFP Battery                  ||
|  |     STOCKOUT IN 5 DAYS              ||
|  |     ===========================     ||
|  |     Current: 53  |  Usage: 10/day   ||
|  |     Open PO: 50 (arrives Jan 20)    ||
|  |                                     ||
|  |     +-----------------------------+ ||
|  |     | ########|........          | || <- Stock chart
|  |     | Now    5d  10d   15d   20d  | ||
|  |     +-----------------------------+ ||
|  |                                     ||
|  |     Recommendation:                 ||
|  |     [Expedite PO-2026-0042]         ||
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  | [!] 5kW Hybrid Inverter                    ||
|  |     STOCKOUT IN 8 DAYS              ||
|  |     ===========================     ||
|  |     Current: 27  |  Usage: 3/day    ||
|  |     Open PO: None                   ||
|  |                                     ||
|  |     +-----------------------------+ ||
|  |     | ######|..                   | ||
|  |     | Now    5d  10d   15d   20d  | ||
|  |     +-----------------------------+ ||
|  |                                     ||
|  |     Recommendation:                 ||
|  |     [Create PO - Qty: 50]           ||
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  | [*] 400W Solar Panel                ||
|  |     STOCKOUT IN 12 DAYS             ||
|  |     ===========================     ||
|  |     Current: 62  |  Usage: 5/day    ||
|  |     Open PO: 25 (arrives Jan 18)    ||
|  |                                     ||
|  |     +-----------------------------+ ||
|  |     | #########|.....             | ||
|  |     | Now    5d  10d   15d   20d  | ||
|  |     +-----------------------------+ ||
|  |                                     ||
|  |     Recommendation:                 ||
|  |     Order 75 more by Jan 15         ||
|  +-------------------------------------+|
|                                         |
+-----------------------------------------+
```

### Product Forecast Detail

```
+=========================================+
| < 10kWh LFP Battery                 [...]  |
+-----------------------------------------+
| Stock Forecast                          |
+-----------------------------------------+
|                                         |
|  +-------------------------------------+|
|  | CURRENT STATUS                      ||
|  | ===================================||
|  |                                     ||
|  | On Hand      Available    Usage     ||
|  |    53           45        10/day    ||
|  |                                     ||
|  | Stockout Date: January 15, 2026     ||
|  | Days Until Stockout: 5              ||
|  +-------------------------------------+|
|                                         |
|  STOCK PROJECTION                       |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  |    60 |##                           ||
|  |    50 | ##                          ||
|  |    40 |  ###                        ||
|  |    30 |     ###                     ||
|  |    20 |        ###                  ||
|  |    10 |           ###  +++++++++    ||
|  |     0 |______________###___________ ||
|  |       Jan 10  15   20   25   30     ||
|  +-------------------------------------+|
|                                         |
|  Legend: ## Current Stock               |
|          +++ Expected from PO           |
|          --- Zero line / Stockout       |
|                                         |
|  OPEN PURCHASE ORDERS                   |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  | PO-2026-0042                        ||
|  | Qty: 50 units                       ||
|  | Expected: Jan 20, 2026              ||
|  | Supplier: BYD Australia      ||
|  | Status: Pending                     ||
|  |                                     ||
|  | [Expedite]  [View PO]               ||
|  +-------------------------------------+|
|                                         |
|  USAGE ANALYSIS                         |
|  -----------------------------------    |
|                                         |
|  Daily Average: 10 units                |
|  Weekly Average: 68 units               |
|  Monthly Average: 295 units             |
|                                         |
|  Peak Day: Monday (14 units)            |
|  Low Day: Sunday (3 units)              |
|                                         |
|  Trend: Increasing (+12% vs last month) |
|                                         |
|  RECOMMENDATION                         |
|  -----------------------------------    |
|                                         |
|  +-------------------------------------+|
|  | Expedite PO-2026-0042               ||
|  |                                     ||
|  | Current arrival: Jan 20             ||
|  | Stockout: Jan 15                    ||
|  | Gap: 5 days of no stock             ||
|  |                                     ||
|  | Request delivery by Jan 14 to       ||
|  | avoid stockout.                     ||
|  |                                     ||
|  | [Contact Supplier]  [Dismiss]       ||
|  +-------------------------------------+|
|                                         |
+-----------------------------------------+
```

---

## Tablet Wireframe (768px)

### Forecast Overview

```
+=======================================================================+
| Inventory > Stock Forecasting                              [Export]   |
+-----------------------------------------------------------------------+
|                                                                       |
|  +-- FORECAST SUMMARY -----------------------------------------------+|
|  |                                                                   ||
|  |  +-------------------+  +-------------------+  +-------------------+
|  |  | STOCKOUT RISKS    |  | REORDER NOW       |  | OPEN POs          |
|  |  | [!] 3 products    |  | 5 products        |  | 8 orders          |
|  |  | Next 14 days      |  | Below threshold   |  | $24,500 pending   |
|  |  +-------------------+  +-------------------+  +-------------------+
|  |                                                                   ||
|  +-------------------------------------------------------------------+|
|                                                                       |
|  [At Risk] [All Products] [Reorder Suggestions] [Expected Receipts]   |
|  =========                                                            |
|                                                                       |
|  +-------------------------------------------------------------------+|
|  | Risk | Product         | Days | Current | Usage  | PO Status      ||
|  +-------------------------------------------------------------------+|
|  | [!]  | 10kWh LFP Battery  | 5    | 53      | 10/day | PO due Jan 20  ||
|  | [!]  | 5kW Hybrid Inverter    | 8    | 27      | 3/day  | No PO          ||
|  | [*]  | Solar Panel 400 | 12   | 62      | 5/day  | PO due Jan 18  ||
|  | [ ]  | Battery 10kWh   | 25   | 38      | 1/day  | No PO          ||
|  | [ ]  | Cable Kit Pro   | 45   | 89      | 2/day  | PO due Jan 22  ||
|  +-------------------------------------------------------------------+|
|                                                                       |
|  [!] = Stockout < 7 days   [*] = Stockout 7-14 days                   |
|                                                                       |
+=======================================================================+
```

### Product Forecast Detail - Split View

```
+=======================================================================+
| < 10kWh LFP Battery - Stock Forecast                      [Create PO]    |
+-----------------------------------------------------------------------+
|                                                                       |
|  +-- PROJECTION CHART -----------------------+  +-- QUICK STATS ----+|
|  |                                           |  |                   ||
|  |  STOCK PROJECTION (30 Days)               |  | On Hand: 53       ||
|  |  ---------------------------------------- |  | Available: 45     ||
|  |                                           |  | Usage: 10/day     ||
|  |    60 |##                                 |  |                   ||
|  |    50 | ###                               |  | Stockout: Jan 15  ||
|  |    40 |    ###                            |  | Days Left: 5      ||
|  |    30 |       ####                        |  |                   ||
|  |    20 |           ####                    |  | Open POs: 1       ||
|  |    10 |               ####  ++++++++++    |  | Pending: 50 units ||
|  |     0 |_________________####___________   |  |                   ||
|  |       10   15   20   25   30   Feb 5      |  +-------------------+|
|  |                                           |                       |
|  |  --- Projected stock (no PO)              |  +-- ACTIONS --------+|
|  |  +++ With expected PO                     |  |                   ||
|  |                                           |  | [Expedite PO]     ||
|  +-------------------------------------------+  | [Create New PO]   ||
|                                                 | [View History]    ||
|                                                 |                   ||
|                                                 +-------------------+|
|                                                                       |
|  +-- USAGE BREAKDOWN ------------------------------------------------+|
|  |                                                                   ||
|  |  Daily Usage by Day of Week:                                      ||
|  |  +---------------------------------------------------------------+|
|  |  | Mon | Tue | Wed | Thu | Fri | Sat | Sun |                     ||
|  |  | 14  | 12  | 11  | 10  | 9   | 8   | 3   |                     ||
|  |  +---------------------------------------------------------------+|
|  |                                                                   ||
|  |  Trend: +12% vs last month    Seasonality: Low in winter         ||
|  |                                                                   ||
|  +-------------------------------------------------------------------+|
|                                                                       |
+=======================================================================+
```

---

## Desktop Wireframe (1280px+)

### Forecast Overview - Full

```
+======================================================================================================+
| Renoz CRM                                                                       [Bell] [User v]      |
+-------------+----------------------------------------------------------------------------------------+
|             |                                                                                        |
| Dashboard   |  Inventory > Stock Forecasting                                                         |
| Customers   |  ------------------------------------------------------------------------------------- |
| Orders      |                                                                                        |
| Products    |  +-- FORECAST SUMMARY -------------------------------------------------------------------+
| Inventory < |  |                                                                                     |
|   Items     |  |  +---------------------+  +---------------------+  +---------------------+  +-------+
|   Locations |  |  | STOCKOUT RISKS      |  | REORDER NOW         |  | OPEN PURCHASE ORDERS|  | TREND |
|   Forecast  |  |  | [!] 3 products      |  | 5 products          |  | 8 orders            |  | +12%  |
|   ========  |  |  | Next 14 days        |  | Below reorder point |  | $24,500 pending     |  | Usage |
|   Counts    |  |  | Est. lost sales: $5k|  | Total need: $8,500  |  | Arriving next 2 wks |  | ^^^^  |
| Reports     |  |  +---------------------+  +---------------------+  +---------------------+  +-------+
| Jobs        |  |                                                                                     |
|             |  +-------------------------------------------------------------------------------------+
|             |                                                                                        |
|             |  [At Risk] [All Products] [Reorder Suggestions] [Expected Receipts] [Usage Analysis]   |
|             |  =========                                                                             |
|             |                                                                                        |
|             |  +------------------------------------------------------------------------------------+|
|             |  |                                                                                    ||
|             |  | Risk | Product         | SKU    | Current | Usage   | Stockout | PO       | Act   ||
|             |  | ------------------------------------------------------------------------------------||
|             |  | [!]  | 10kWh LFP Battery  | BAT-LFP-10KWH | 53      | 10/day  | 5 days   | Jan 20   | [->]  ||
|             |  | [!]  | 5kW Hybrid Inverter    | INV-HYB-5KW | 27      | 3/day   | 8 days   | None     | [+PO] ||
|             |  | [*]  | Solar Panel 400 | SOL-RES-400W | 62      | 5/day   | 12 days  | Jan 18   | [->]  ||
|             |  | [ ]  | Battery 10kWh   | BP-10K | 38      | 1.5/day | 25 days  | None     | [+PO] ||
|             |  | [ ]  | Cable Kit Pro   | CK-PRO | 89      | 2/day   | 45 days  | Jan 22   | [->]  ||
|             |  | [ ]  | Mounting Rails  | MR-STD | 145     | 5/day   | 29 days  | None     | [+PO] ||
|             |  |                                                                                    ||
|             |  +------------------------------------------------------------------------------------+|
|             |                                                                                        |
|             |  Legend: [!] Critical (<7 days)  [*] Warning (7-14 days)  [ ] Normal (>14 days)        |
|             |  [->] View/Expedite PO   [+PO] Create Purchase Order                                   |
|             |                                                                                        |
+-------------+----------------------------------------------------------------------------------------+
```

### Product Forecast Detail - Desktop

```
+======================================================================================================+
| Renoz CRM                                                                       [Bell] [User v]      |
+-------------+----------------------------------------------------------------------------------------+
|             |                                                                                        |
| Dashboard   |  < Back to Forecasting                                                                 |
| Inventory < |                                                                                        |
|             |  10kWh LFP Battery (BAT-LFP-10KWH) - Stock Forecast                     [Create PO] [Expedite]   |
|             |  ------------------------------------------------------------------------------------- |
|             |                                                                                        |
|             |  +-- STOCK PROJECTION CHART -----------------------------------------------------------+|
|             |  |                                                                                     |
|             |  |  +---------------------------------------------------------------------------------+|
|             |  |  |                                                                                 ||
|             |  |  |  100 |                                                                          ||
|             |  |  |   80 |                                                                          ||
|             |  |  |   60 |##                                                         ++++++++++++   ||
|             |  |  |   50 | ###                                                   ++++              ||
|             |  |  |   40 |    ####                                          +++++                  ||
|             |  |  |   30 |        #####                                +++++                       ||
|             |  |  |   20 |             ######                     +++++                            ||
|             |  |  |   10 |                   #######         +++++                                 ||
|             |  |  |    0 |________________________###########_____________________________________  ||
|             |  |  |      Jan 10    15    20    25    30    Feb 5    10    15    20                 ||
|             |  |  +---------------------------------------------------------------------------------+|
|             |  |                                                                                     |
|             |  |  --- Projected stock (without pending POs)   +++ Projected with PO arrivals       |
|             |  |  *** Reorder point (25 units)                === Safety stock (10 units)          |
|             |  |                                                                                     |
|             |  +-------------------------------------------------------------------------------------+|
|             |                                                                                        |
|             |  +-- METRICS ---------------------+  +-- OPEN POs --------------------+  +-- ACTIONS -+|
|             |  |                                |  |                                |  |            ||
|             |  | Current Stock: 53 units        |  | PO-2026-0042                   |  | [Expedite] ||
|             |  | Available: 45 units            |  | Qty: 50 units                  |  | [New PO]   ||
|             |  | Reserved: 8 units              |  | Expected: Jan 20               |  | [Adjust]   ||
|             |  |                                |  | Supplier: SunTech              |  |            ||
|             |  | Avg Usage: 10 units/day        |  | Status: Confirmed              |  | [History]  ||
|             |  | Weekly: 68 units               |  |                                |  |            ||
|             |  | Monthly: 295 units             |  | [View PO] [Contact Supplier]   |  |            ||
|             |  |                                |  |                                |  +------------+|
|             |  | Stockout Date: Jan 15          |  +--------------------------------+               ||
|             |  | Days Left: 5 days              |                                                    ||
|             |  |                                |  +-- RECOMMENDATION ---------------+               ||
|             |  | Reorder Point: 25 units        |  |                                |               ||
|             |  | Lead Time: 5 days              |  | [!] EXPEDITE REQUIRED           |               ||
|             |  |                                |  |                                |               ||
|             |  | Trend: +12% vs last month      |  | Stockout: Jan 15               |               ||
|             |  |                                |  | PO Arrival: Jan 20             |               ||
|             |  +--------------------------------+  | Gap: 5 days without stock      |               ||
|             |                                      |                                |               ||
|             |                                      | Request Jan 14 delivery or     |               ||
|             |                                      | place rush order for 30 units. |               ||
|             |                                      |                                |               ||
|             |                                      | [Take Action]                  |               ||
|             |                                      +--------------------------------+               ||
|             |                                                                                        |
+-------------+----------------------------------------------------------------------------------------+
```

### Reorder Suggestions View

```
+======================================================================================================+
|                                                                                                      |
| [At Risk] [All Products] [Reorder Suggestions] [Expected Receipts] [Usage Analysis]        [Export] |
|                          ====================                                                        |
|                                                                                                      |
| +-- REORDER RECOMMENDATIONS -----------------------------------------------------------------------+ |
| |                                                                                                  | |
| |  Based on usage patterns, lead times, and current stock levels                                   | |
| |                                                                                                  | |
| |  +----------------------------------------------------------------------------------------------+| |
| |  |                                                                                              || |
| |  | Priority | Product         | Current | Usage   | Days | Suggested | Est Cost | Action       || |
| |  | -------------------------------------------------------------------------------------------  || |
| |  | URGENT   | 5kW Hybrid Inverter    | 27      | 3/day   | 8    | 50 units  | $24,500  | [Create PO]  || |
| |  | URGENT   | 10kWh LFP Battery  | 53      | 10/day  | 5    | Expedite  | N/A      | [Expedite]   || |
| |  | HIGH     | Solar Panel 400 | 62      | 5/day   | 12   | 75 units  | $21,375  | [Create PO]  || |
| |  | MEDIUM   | Battery 10kWh   | 38      | 1.5/day | 25   | 30 units  | $29,850  | [Create PO]  || |
| |  | MEDIUM   | Mounting Rails  | 145     | 5/day   | 29   | 100 units | $1,500   | [Create PO]  || |
| |  |                                                                                              || |
| |  +----------------------------------------------------------------------------------------------+| |
| |                                                                                                  | |
| |  Total Recommended Investment: $77,225                                                           | |
| |                                                                                                  | |
| |  [Create All Recommended POs]  [Export Recommendations]  [Configure Thresholds]                  | |
| |                                                                                                  | |
| +--------------------------------------------------------------------------------------------------+ |
|                                                                                                      |
+======================================================================================================+
```

---

## Interaction States

### Loading States

```
FORECAST LOADING:
+------------------------------------------------------------------------------------+
| STOCKOUT RISKS         | REORDER NOW          | OPEN POs                          |
+------------------------------------------------------------------------------------+
| [..................] | [..................] | [...................] |
+------------------------------------------------------------------------------------+

Product         | Current | Usage   | Stockout | PO       | Action
+------------------------------------------------------------------------------------+
[.............] | [.....] | [.....] | [......] | [......] | [.....] |
[.............] | [.....] | [.....] | [......] | [......] | [.....] |
+------------------------------------------------------------------------------------+
â†‘ Skeleton with shimmer

CHART LOADING:
+----------------------------------------+
|                                        |
|   Calculating forecast...              |
|   +--------------------------------+   |
|   | [==================          ] |   |
|   +--------------------------------+   |
|                                        |
|   Analyzing 90 days of usage data...   |
|                                        |
+----------------------------------------+

RECOMMENDATION CALCULATING:
+----------------------------------------+
|                                        |
|   Generating recommendations...        |
|   +--------------------------------+   |
|   | [============             ]    |   |
|   +--------------------------------+   |
|                                        |
|   Factoring in lead times and POs...   |
|                                        |
+----------------------------------------+
```

### Empty States

```
NO STOCKOUT RISKS:
+----------------------------------------+
|                                        |
|           +-------------+              |
|           |   [check]   |              |
|           +-------------+              |
|                                        |
|    No Stockout Risks                   |
|                                        |
|    All products have sufficient        |
|    stock for the next 30 days.         |
|                                        |
|    [View All Products]                 |
|                                        |
+----------------------------------------+

NO USAGE DATA:
+----------------------------------------+
|                                        |
|           +-------------+              |
|           |   [chart]   |              |
|           +-------------+              |
|                                        |
|    Insufficient Usage Data             |
|                                        |
|    This product needs at least         |
|    30 days of movement history         |
|    for accurate forecasting.           |
|                                        |
|    Current data: 12 days               |
|                                        |
|    [View Movements]                    |
|                                        |
+----------------------------------------+

NO OPEN POs:
+----------------------------------------+
|                                        |
|    No Open Purchase Orders             |
|                                        |
|    There are no pending orders         |
|    for this product.                   |
|                                        |
|    [Create Purchase Order]             |
|                                        |
+----------------------------------------+
```

### Error States

```
FORECAST CALCULATION ERROR:
+----------------------------------------+
| [!] Forecast Error                     |
|                                        |
| Could not calculate forecast for       |
| 10kWh LFP Battery.                        |
|                                        |
| Error: Inconsistent movement data      |
|                                        |
| [View Movements]  [Retry]              |
+----------------------------------------+

LEAD TIME UNKNOWN:
+----------------------------------------+
| [*] Missing Lead Time                  |
|                                        |
| No lead time configured for            |
| supplier BYD Australia.         |
|                                        |
| Using default of 7 days.               |
|                                        |
| [Configure Lead Time]  [OK]            |
+----------------------------------------+
```

### Success States

```
PO CREATED FROM RECOMMENDATION:
+----------------------------------------+
| [ok] Purchase Order Created            |
|                                        |
| PO-2026-0055 for 5kW Hybrid Inverter          |
| Qty: 50 units @ $490.00                |
| Total: $24,500.00                      |
| Expected: Jan 20, 2026                 |
|                                        |
| [View PO]  [Done]                      |
+----------------------------------------+

PO EXPEDITED:
+----------------------------------------+
| [ok] Expedite Request Sent             |
|                                        |
| Supplier has been notified to          |
| expedite PO-2026-0042.                 |
|                                        |
| Requested delivery: Jan 14             |
| Original delivery: Jan 20              |
|                                        |
| [View PO]  [Done]                      |
+----------------------------------------+
```

---

## Accessibility Notes

### Focus Order

1. **Forecast Overview**
   - Tab to summary cards
   - Tab to view tabs
   - Tab to search/filters
   - Tab through table rows
   - Tab to row actions
   - Tab to pagination

2. **Product Forecast Detail**
   - Tab to chart (with keyboard navigation)
   - Tab to metrics
   - Tab to PO section
   - Tab to actions
   - Tab to recommendations

3. **Chart Navigation**
   - Arrow keys to navigate data points
   - Enter to view point details
   - Escape to exit chart focus

### ARIA Requirements

```html
<!-- Forecast Summary -->
<div role="region" aria-labelledby="forecast-title">
  <h2 id="forecast-title">Stock Forecasting</h2>

  <div role="group" aria-label="Forecast summary">
    <div aria-label="3 products at risk of stockout in next 14 days">
      <span class="value">[!] 3</span>
      <span class="label">Stockout Risks</span>
    </div>
  </div>
</div>

<!-- Risk Table -->
<table role="grid" aria-label="Product stockout forecast">
  <thead>
    <tr role="row">
      <th role="columnheader">Risk Level</th>
      <th role="columnheader" aria-sort="ascending">Days to Stockout</th>
    </tr>
  </thead>
  <tbody>
    <tr role="row" aria-label="10kWh LFP Battery, critical risk, stockout in 5 days">
      <td role="gridcell">
        <span aria-label="Critical risk">[!]</span>
      </td>
      <td role="gridcell">5 days</td>
    </tr>
  </tbody>
</table>

<!-- Forecast Chart -->
<figure role="img" aria-label="Stock projection chart for 10kWh LFP Battery">
  <figcaption>
    Stock projected to deplete to zero on January 15.
    With pending PO, stock will recover to 50 units on January 20.
  </figcaption>
  <svg aria-hidden="true"><!-- chart --></svg>
</figure>

<!-- Recommendation -->
<div
  role="alert"
  aria-live="polite"
  aria-labelledby="rec-title"
>
  <h3 id="rec-title">Recommendation: Expedite Required</h3>
  <p>Request delivery by January 14 to avoid 5-day stockout.</p>
  <button>Take Action</button>
</div>
```

### Screen Reader Announcements

- Page loaded: "Stock forecasting loaded, 3 products at stockout risk"
- Risk level: "10kWh LFP Battery, critical risk, stockout in 5 days, 10 units per day usage"
- Chart point: "January 15, projected stock: 0 units, stockout day"
- Recommendation: "Urgent: Expedite PO-2026-0042 to avoid stockout"
- Action taken: "Expedite request sent to supplier"

---

## Animation Choreography

### Forecast Load

```
SUMMARY CARDS:
- Duration: 300ms
- Stagger: 100ms between cards
- Transform: translateY(20px) -> translateY(0)
- Opacity: 0 -> 1

RISK INDICATORS:
- Duration: 400ms after cards
- Scale: 0 -> 1.1 -> 1
- Color: pulse for critical items
```

### Chart Animation

```
INITIAL RENDER:
- Duration: 1000ms
- Line: draw from left to right
- Easing: ease-out

PROJECTION LINE:
- Duration: 500ms (after main line)
- Dashed line: draw from current stock point
- Stockout point: pulse red

PO ARRIVAL:
- Duration: 300ms
- Jump animation at arrival date
- Color: green highlight
```

### Risk Updates

```
RISK LEVEL CHANGE:
- Duration: 300ms
- Old indicator: fade out
- New indicator: scale in with color
- Row: highlight flash

STOCKOUT COUNTDOWN:
- Duration: pulse every second on critical items
- Color: red pulse for < 3 days
```

### Recommendations

```
RECOMMENDATION APPEAR:
- Duration: 400ms
- Slide in from right
- Border pulse for urgent

ACTION TAKEN:
- Duration: 300ms
- Button: loading spinner
- Success: checkmark animation
- Card: slide out or update
```

---

## Component Props Interfaces

```typescript
// Forecast Overview
interface InventoryForecastPageProps {
  /** Default view */
  initialView?: 'at_risk' | 'all' | 'reorder' | 'receipts' | 'usage';
  /** Risk threshold in days */
  riskThresholdDays?: number;
  /** Warning threshold in days */
  warningThresholdDays?: number;
}

interface ForecastSummary {
  stockoutRiskCount: number;
  stockoutRiskValue: number;
  reorderNowCount: number;
  reorderNowValue: number;
  openPOCount: number;
  openPOValue: number;
  usageTrendPercent: number;
}

interface ProductForecast {
  productId: string;
  productName: string;
  sku: string;
  currentStock: number;
  availableStock: number;
  averageDailyUsage: number;
  averageWeeklyUsage: number;
  averageMonthlyUsage: number;
  daysUntilStockout: number;
  stockoutDate: Date;
  riskLevel: 'critical' | 'warning' | 'normal';
  reorderPoint: number;
  leadTimeDays: number;
  pendingPOQty: number;
  pendingPODate?: Date;
  pendingPOId?: string;
  usageTrend: number; // percentage change vs previous period
  recommendation?: ForecastRecommendation;
}

// Forecast Chart
interface ForecastChartProps {
  /** Product forecast data */
  forecast: ProductForecast;
  /** Projection days */
  projectionDays?: number;
  /** Show pending POs */
  showPendingPOs?: boolean;
  /** Show reorder point line */
  showReorderPoint?: boolean;
  /** Show safety stock line */
  showSafetyStock?: boolean;
  /** Interactive mode */
  interactive?: boolean;
  /** Callback when point clicked */
  onPointClick?: (date: Date, value: number) => void;
}

interface ForecastDataPoint {
  date: Date;
  projectedStock: number;
  projectedWithPO: number;
  isStockout: boolean;
  isPOArrival: boolean;
  poId?: string;
  poQty?: number;
}

// Product Forecast Detail
interface ProductForecastDetailProps {
  /** Product ID */
  productId: string;
  /** Callback when PO created */
  onCreatePO?: (productId: string, qty: number) => void;
  /** Callback when PO expedited */
  onExpeditePO?: (poId: string) => void;
}

// Usage Analysis
interface UsageAnalysisProps {
  /** Product ID */
  productId: string;
  /** Analysis period in days */
  periodDays?: number;
  /** Show day-of-week breakdown */
  showDayBreakdown?: boolean;
  /** Show trend analysis */
  showTrend?: boolean;
  /** Show seasonality */
  showSeasonality?: boolean;
}

interface UsageAnalysis {
  dailyAverage: number;
  weeklyAverage: number;
  monthlyAverage: number;
  peakDay: { day: string; usage: number };
  lowDay: { day: string; usage: number };
  trendPercent: number;
  trendDirection: 'increasing' | 'decreasing' | 'stable';
  seasonalityNote?: string;
  dayOfWeekUsage: { day: string; average: number }[];
}

// Forecast Recommendation
interface ForecastRecommendation {
  type: 'expedite' | 'create_po' | 'increase_qty' | 'ok';
  priority: 'urgent' | 'high' | 'medium' | 'low';
  message: string;
  suggestedAction: string;
  suggestedQuantity?: number;
  suggestedDate?: Date;
  estimatedCost?: number;
}

// Reorder Suggestions
interface ReorderSuggestionsProps {
  /** Max items to show */
  maxItems?: number;
  /** Group by priority */
  groupByPriority?: boolean;
  /** Callback when action taken */
  onAction?: (productId: string, action: 'create_po' | 'expedite') => void;
}

interface ReorderSuggestion {
  productId: string;
  productName: string;
  sku: string;
  currentStock: number;
  dailyUsage: number;
  daysUntilStockout: number;
  suggestedQuantity: number;
  estimatedCost: number;
  priority: 'urgent' | 'high' | 'medium' | 'low';
  actionType: 'create_po' | 'expedite';
  existingPOId?: string;
}

// Expected Receipts
interface ExpectedReceiptsProps {
  /** Date range filter */
  dateRange?: { start: Date; end: Date };
  /** Group by date */
  groupByDate?: boolean;
}

interface ExpectedReceipt {
  poId: string;
  poNumber: string;
  productId: string;
  productName: string;
  sku: string;
  quantity: number;
  expectedDate: Date;
  supplierId: string;
  supplierName: string;
  status: 'pending' | 'confirmed' | 'shipped' | 'delayed';
  daysUntilArrival: number;
}
```

---

## Component Files

| File | Purpose |
|------|---------|
| `src/routes/_authed/inventory/forecast.tsx` | Forecast main page |
| `src/components/domain/inventory/forecast-chart.tsx` | Stock projection chart |
| `src/components/domain/inventory/forecast-summary.tsx` | Summary cards |
| `src/components/domain/inventory/forecast-table.tsx` | Product risk table |
| `src/components/domain/inventory/usage-analysis.tsx` | Usage breakdown |
| `src/components/domain/inventory/reorder-suggestions.tsx` | Recommendations list |
| `src/components/domain/inventory/expected-receipts.tsx` | Pending POs table |
| `src/components/domain/inventory/forecast-recommendation.tsx` | Action card |

---

## Design References

- **Risk Colors**: Red (#EF4444) critical, Orange (#F97316) warning, Green (#22C55E) normal
- **Chart Style**: Line chart with area fill, dashed line for projection
- **Stockout Indicator**: Red vertical line with pulse
- **PO Arrival**: Green step up in chart line
- **Trend Arrows**: Up arrow green, down arrow red
- **Recommendation Card**: Left border accent by priority
