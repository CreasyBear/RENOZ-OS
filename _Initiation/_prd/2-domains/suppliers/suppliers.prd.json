{
  "id": "DOM-SUPPLIERS",
  "name": "Supplier Relationship Management System",
  "description": "Complete supplier lifecycle management platform providing end-to-end procurement operations from supplier onboarding through purchase order fulfillment, performance tracking, and strategic relationship management.",
  "created": "2026-01-10",
  "updated": "2026-01-10",
  "priority": 6,
  "phase": "core-business",
  "version": "1.1",
  "business_value": {
    "procurement_efficiency": true,
    "supplier_performance": true,
    "cost_optimization": true,
    "description": "Strategic supplier management enabling optimal procurement operations and supplier partnerships"
  },
  "system_requirements": {
    "database": {
      "suppliers": {
        "description": "Comprehensive supplier profile and relationship management",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "supplierCode": "varchar(20) UNIQUE NOT NULL",
          "name": "varchar(255) NOT NULL",
          "contactName": "varchar(100)",
          "email": "varchar(255)",
          "phone": "varchar(20)",
          "address": "jsonb",
          "taxId": "varchar(50)",
          "paymentTerms": "enum('net_15', 'net_30', 'net_45', 'net_60', 'cod', 'prepaid') DEFAULT 'net_30'",
          "currency": "varchar(3) DEFAULT 'AUD'",
          "status": "enum('active', 'inactive', 'suspended', 'blacklisted') DEFAULT 'active'",
          "supplierType": "enum('manufacturer', 'distributor', 'retailer', 'service', 'raw_materials')",
          "leadTimeDays": "integer",
          "minimumOrderValue": "decimal(10,2)",
          "maximumOrderValue": "decimal(10,2)",
          "qualityRating": "decimal(3,1) CHECK (qualityRating >= 0 AND qualityRating <= 5)",
          "deliveryRating": "decimal(3,1) CHECK (deliveryRating >= 0 AND deliveryRating <= 5)",
          "communicationRating": "decimal(3,1) CHECK (communicationRating >= 0 AND communicationRating <= 5)",
          "overallRating": "decimal(3,1) CHECK (overallRating >= 0 AND overallRating <= 5)",
          "notes": "text",
          "tags": "text[] DEFAULT '{}'",
          "createdBy": "uuid REFERENCES users(id)",
          "updatedBy": "uuid REFERENCES users(id)",
          "version": "integer NOT NULL DEFAULT 1",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()",
          "updatedAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "supplierCode",
          "status",
          "supplierType",
          "overallRating",
          "(organizationId, status)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "overallRating = (qualityRating + deliveryRating + communicationRating) / 3"
        ]
      },
      "purchaseOrders": {
        "description": "Complete purchase order lifecycle management",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "poNumber": "varchar(50) UNIQUE NOT NULL",
          "supplierId": "uuid NOT NULL REFERENCES suppliers(id)",
          "status": "enum('draft', 'pending_approval', 'approved', 'ordered', 'partial_received', 'received', 'cancelled', 'closed') DEFAULT 'draft'",
          "orderDate": "date NOT NULL",
          "requiredDate": "date",
          "shipToAddress": "jsonb",
          "billToAddress": "jsonb",
          "subtotal": "decimal(10,2) NOT NULL DEFAULT 0",
          "taxAmount": "decimal(10,2) NOT NULL DEFAULT 0",
          "shippingAmount": "decimal(10,2) NOT NULL DEFAULT 0",
          "discountAmount": "decimal(10,2) NOT NULL DEFAULT 0",
          "totalAmount": "decimal(10,2) NOT NULL DEFAULT 0",
          "currency": "varchar(3) DEFAULT 'AUD'",
          "paymentTerms": "varchar(50)",
          "notes": "text",
          "approvedBy": "uuid REFERENCES users(id)",
          "approvedAt": "timestamp",
          "orderedBy": "uuid NOT NULL REFERENCES users(id)",
          "orderedAt": "timestamp",
          "expectedDeliveryDate": "date",
          "actualDeliveryDate": "date",
          "createdBy": "uuid REFERENCES users(id)",
          "updatedBy": "uuid REFERENCES users(id)",
          "version": "integer NOT NULL DEFAULT 1",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()",
          "updatedAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "poNumber",
          "supplierId",
          "status",
          "orderDate",
          "requiredDate",
          "(organizationId, status)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "totalAmount = subtotal + taxAmount + shippingAmount - discountAmount",
          "approvedAt IS NOT NULL WHEN status != 'draft'"
        ]
      },
      "purchaseOrderItems": {
        "description": "Individual line items on purchase orders",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "purchaseOrderId": "uuid NOT NULL REFERENCES purchaseOrders(id)",
          "productId": "uuid NOT NULL REFERENCES products(id)",
          "productName": "varchar(255) NOT NULL",
          "productSku": "varchar(100)",
          "description": "text",
          "quantity": "integer NOT NULL CHECK (quantity > 0)",
          "unitPrice": "decimal(10,2) NOT NULL CHECK (unitPrice >= 0)",
          "lineTotal": "decimal(10,2) NOT NULL",
          "quantityReceived": "integer NOT NULL DEFAULT 0",
          "quantityRejected": "integer NOT NULL DEFAULT 0",
          "expectedDeliveryDate": "date",
          "notes": "text",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "purchaseOrderId",
          "productId",
          "(organizationId, purchaseOrderId)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "lineTotal = quantity * unitPrice",
          "quantityReceived <= quantity",
          "quantityRejected <= quantityReceived"
        ]
      },
      "purchaseOrderApprovals": {
        "description": "Multi-level approval workflow for purchase orders",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "purchaseOrderId": "uuid NOT NULL REFERENCES purchaseOrders(id)",
          "approverId": "uuid NOT NULL REFERENCES users(id)",
          "level": "integer NOT NULL",
          "status": "enum('pending', 'approved', 'rejected', 'escalated') DEFAULT 'pending'",
          "comments": "text",
          "approvedAt": "timestamp",
          "escalatedTo": "uuid REFERENCES users(id)",
          "escalatedAt": "timestamp",
          "createdBy": "uuid REFERENCES users(id)",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "purchaseOrderId",
          "approverId",
          "status",
          "(organizationId, status)",
          "(organizationId, createdAt DESC)"
        ],
        "unique": [
          "purchaseOrderId",
          "level"
        ]
      },
      "purchaseOrderApprovalRules": {
        "description": "Configurable approval rules based on order value and category",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "name": "varchar(100) NOT NULL",
          "minAmount": "decimal(10,2) DEFAULT 0",
          "maxAmount": "decimal(10,2)",
          "requiresApproval": "boolean DEFAULT true",
          "approverRoles": "text[] NOT NULL",
          "escalationHours": "integer DEFAULT 24",
          "autoApproveUnder": "decimal(10,2)",
          "isActive": "boolean DEFAULT true",
          "createdBy": "uuid REFERENCES users(id)",
          "updatedBy": "uuid REFERENCES users(id)",
          "version": "integer NOT NULL DEFAULT 1",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()",
          "updatedAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "isActive",
          "minAmount",
          "maxAmount",
          "(organizationId, isActive)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "maxAmount > minAmount OR maxAmount IS NULL"
        ]
      },
      "supplierPerformanceMetrics": {
        "description": "Historical performance tracking for suppliers",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "supplierId": "uuid NOT NULL REFERENCES suppliers(id)",
          "metricDate": "date NOT NULL",
          "onTimeDeliveryRate": "decimal(5,2) CHECK (onTimeDeliveryRate >= 0 AND onTimeDeliveryRate <= 100)",
          "qualityRating": "decimal(3,1) CHECK (qualityRating >= 0 AND qualityRating <= 5)",
          "averageLeadTimeDays": "integer",
          "totalOrders": "integer NOT NULL DEFAULT 0",
          "totalOrderValue": "decimal(10,2) NOT NULL DEFAULT 0",
          "rejectedItemsRate": "decimal(5,2) CHECK (rejectedItemsRate >= 0 AND rejectedItemsRate <= 100)",
          "communicationResponsiveness": "decimal(3,1) CHECK (communicationResponsiveness >= 0 AND communicationResponsiveness <= 5)",
          "createdBy": "uuid REFERENCES users(id)",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "supplierId",
          "metricDate",
          "(organizationId, supplierId)",
          "(organizationId, createdAt DESC)"
        ],
        "unique": [
          "supplierId",
          "metricDate"
        ]
      },
      "supplierPriceLists": {
        "description": "Supplier-specific pricing agreements",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "supplierId": "uuid NOT NULL REFERENCES suppliers(id)",
          "productId": "uuid NOT NULL REFERENCES products(id)",
          "price": "decimal(10,2) NOT NULL CHECK (price >= 0)",
          "minQuantity": "integer DEFAULT 1",
          "effectiveDate": "date NOT NULL DEFAULT CURRENT_DATE",
          "expiryDate": "date",
          "discountPercent": "decimal(5,2) CHECK (discountPercent >= 0 AND discountPercent <= 100)",
          "isPreferredPrice": "boolean DEFAULT false",
          "notes": "text",
          "createdBy": "uuid REFERENCES users(id)",
          "updatedBy": "uuid REFERENCES users(id)",
          "version": "integer NOT NULL DEFAULT 1",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()",
          "updatedAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "supplierId",
          "productId",
          "effectiveDate",
          "isPreferredPrice",
          "(organizationId, supplierId)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "expiryDate > effectiveDate OR expiryDate IS NULL",
          "minQuantity > 0"
        ]
      },
      "purchaseOrderReceipts": {
        "description": "Goods receipt tracking with quality control",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "purchaseOrderId": "uuid NOT NULL REFERENCES purchaseOrders(id)",
          "receivedBy": "uuid NOT NULL REFERENCES users(id)",
          "receivedAt": "timestamp NOT NULL DEFAULT NOW()",
          "receiptNumber": "varchar(50) UNIQUE",
          "carrier": "varchar(100)",
          "trackingNumber": "varchar(100)",
          "totalItemsReceived": "integer NOT NULL DEFAULT 0",
          "totalItemsRejected": "integer NOT NULL DEFAULT 0",
          "qualityNotes": "text",
          "status": "enum('pending_inspection', 'accepted', 'partially_accepted', 'rejected') DEFAULT 'pending_inspection'",
          "inspectionCompletedAt": "timestamp",
          "inspectionCompletedBy": "uuid REFERENCES users(id)",
          "createdBy": "uuid REFERENCES users(id)",
          "updatedBy": "uuid REFERENCES users(id)",
          "version": "integer NOT NULL DEFAULT 1",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()",
          "updatedAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "purchaseOrderId",
          "receivedAt",
          "status",
          "(organizationId, status)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "totalItemsReceived >= 0",
          "totalItemsRejected >= 0"
        ]
      },
      "purchaseOrderReceiptItems": {
        "description": "Individual item receipts with quality tracking",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "receiptId": "uuid NOT NULL REFERENCES purchaseOrderReceipts(id)",
          "purchaseOrderItemId": "uuid NOT NULL REFERENCES purchaseOrderItems(id)",
          "quantityReceived": "integer NOT NULL CHECK (quantityReceived >= 0)",
          "quantityAccepted": "integer NOT NULL CHECK (quantityAccepted >= 0)",
          "quantityRejected": "integer NOT NULL CHECK (quantityRejected >= 0)",
          "rejectionReason": "enum('damaged', 'wrong_item', 'quality_issue', 'short_shipment', 'other')",
          "rejectionNotes": "text",
          "condition": "enum('new', 'refurbished', 'used', 'damaged') DEFAULT 'new'",
          "serialNumbers": "text[]",
          "batchNumber": "varchar(100)",
          "expiryDate": "date",
          "qualityCheckPassed": "boolean DEFAULT true",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "receiptId",
          "purchaseOrderItemId",
          "(organizationId, receiptId)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "quantityAccepted + quantityRejected = quantityReceived",
          "quantityReceived >= 0"
        ]
      },
      "purchaseOrderAmendments": {
        "description": "Change tracking for purchase order modifications",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "purchaseOrderId": "uuid NOT NULL REFERENCES purchaseOrders(id)",
          "amendmentNumber": "integer NOT NULL",
          "requestedBy": "uuid NOT NULL REFERENCES users(id)",
          "approvedBy": "uuid REFERENCES users(id)",
          "status": "enum('requested', 'approved', 'rejected', 'applied') DEFAULT 'requested'",
          "reason": "text NOT NULL",
          "changes": "jsonb NOT NULL",
          "originalValues": "jsonb NOT NULL",
          "newValues": "jsonb NOT NULL",
          "requestedAt": "timestamp NOT NULL DEFAULT NOW()",
          "approvedAt": "timestamp",
          "appliedAt": "timestamp",
          "createdBy": "uuid REFERENCES users(id)",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "purchaseOrderId",
          "status",
          "requestedAt",
          "(organizationId, status)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "amendmentNumber > 0"
        ]
      },
      "purchaseOrderCosts": {
        "description": "Additional costs tracking (shipping, duties, insurance)",
        "fields": {
          "id": "uuid PRIMARY KEY",
          "organizationId": "uuid NOT NULL REFERENCES organizations(id) ON DELETE CASCADE",
          "purchaseOrderId": "uuid NOT NULL REFERENCES purchaseOrders(id)",
          "costType": "enum('freight', 'duty', 'insurance', 'handling', 'customs', 'other') NOT NULL",
          "description": "text",
          "amount": "decimal(10,2) NOT NULL CHECK (amount >= 0)",
          "currency": "varchar(3) DEFAULT 'AUD'",
          "allocationMethod": "enum('equal', 'by_value', 'by_weight', 'by_quantity') DEFAULT 'equal'",
          "isIncludedInTotal": "boolean DEFAULT true",
          "supplierInvoiceNumber": "varchar(100)",
          "notes": "text",
          "createdBy": "uuid REFERENCES users(id)",
          "updatedBy": "uuid REFERENCES users(id)",
          "version": "integer NOT NULL DEFAULT 1",
          "createdAt": "timestamp NOT NULL DEFAULT NOW()",
          "updatedAt": "timestamp NOT NULL DEFAULT NOW()"
        },
        "indexes": [
          "organizationId",
          "purchaseOrderId",
          "costType",
          "(organizationId, purchaseOrderId)",
          "(organizationId, createdAt DESC)"
        ],
        "constraints": [
          "amount >= 0"
        ]
      }
    },
    "api_endpoints": {
      "suppliers": {
        "list": {
          "method": "GET",
          "path": "/api/suppliers",
          "query_params": [
            "page",
            "limit",
            "status",
            "type",
            "rating",
            "search",
            "sortBy",
            "sortDir"
          ],
          "response": {
            "suppliers": "Supplier[]",
            "total": "number",
            "page": "number",
            "limit": "number",
            "metrics": {
              "totalActive": "number",
              "avgRating": "number"
            }
          },
          "description": "List suppliers with filtering and performance metrics"
        },
        "get": {
          "method": "GET",
          "path": "/api/suppliers/:id",
          "response": {
            "supplier": "Supplier",
            "performanceMetrics": "SupplierPerformanceMetrics[]",
            "priceList": "SupplierPriceList[]",
            "recentOrders": "PurchaseOrder[]",
            "contacts": "SupplierContact[]"
          },
          "description": "Get complete supplier details with performance data"
        },
        "create": {
          "method": "POST",
          "path": "/api/suppliers",
          "body": {
            "supplierCode": "string",
            "name": "string",
            "contactName": "string?",
            "email": "string?",
            "phone": "string?",
            "supplierType": "SupplierType?",
            "paymentTerms": "PaymentTerms?",
            "leadTimeDays": "number?"
          },
          "response": {
            "supplier": "Supplier"
          },
          "description": "Create new supplier"
        },
        "update": {
          "method": "PUT",
          "path": "/api/suppliers/:id",
          "body": {
            "name": "string?",
            "contactName": "string?",
            "status": "SupplierStatus?",
            "rating": "number?",
            "paymentTerms": "PaymentTerms?"
          },
          "response": {
            "supplier": "Supplier"
          },
          "description": "Update supplier information"
        },
        "updatePerformance": {
          "method": "POST",
          "path": "/api/suppliers/:id/performance",
          "body": {
            "qualityRating": "number?",
            "deliveryRating": "number?",
            "communicationRating": "number?"
          },
          "response": {
            "supplier": "Supplier"
          },
          "description": "Update supplier performance ratings"
        }
      },
      "purchaseOrders": {
        "list": {
          "method": "GET",
          "path": "/api/purchase-orders",
          "query_params": [
            "page",
            "limit",
            "status",
            "supplierId",
            "dateFrom",
            "dateTo",
            "search"
          ],
          "response": {
            "orders": "PurchaseOrder[]",
            "total": "number",
            "page": "number",
            "limit": "number",
            "metrics": {
              "totalValue": "number",
              "avgLeadTime": "number"
            }
          },
          "description": "List purchase orders with filtering and metrics"
        },
        "get": {
          "method": "GET",
          "path": "/api/purchase-orders/:id",
          "response": {
            "order": "PurchaseOrder",
            "items": "PurchaseOrderItem[]",
            "approvals": "PurchaseOrderApproval[]",
            "receipts": "PurchaseOrderReceipt[]",
            "amendments": "PurchaseOrderAmendment[]",
            "costs": "PurchaseOrderCost[]",
            "supplier": "Supplier"
          },
          "description": "Get complete purchase order details"
        },
        "create": {
          "method": "POST",
          "path": "/api/purchase-orders",
          "body": {
            "supplierId": "uuid",
            "items": "PurchaseOrderItemInput[]",
            "requiredDate": "date?",
            "notes": "string?"
          },
          "response": {
            "order": "PurchaseOrder",
            "items": "PurchaseOrderItem[]"
          },
          "description": "Create new purchase order"
        },
        "update": {
          "method": "PUT",
          "path": "/api/purchase-orders/:id",
          "body": {
            "status": "PurchaseOrderStatus?",
            "requiredDate": "date?",
            "notes": "string?"
          },
          "response": {
            "order": "PurchaseOrder"
          },
          "description": "Update purchase order"
        },
        "submitForApproval": {
          "method": "POST",
          "path": "/api/purchase-orders/:id/submit-approval",
          "response": {
            "order": "PurchaseOrder",
            "approvals": "PurchaseOrderApproval[]"
          },
          "description": "Submit purchase order for approval workflow"
        },
        "approve": {
          "method": "POST",
          "path": "/api/purchase-orders/:id/approve",
          "body": {
            "comments": "string?"
          },
          "response": {
            "order": "PurchaseOrder",
            "approval": "PurchaseOrderApproval"
          },
          "description": "Approve purchase order"
        },
        "reject": {
          "method": "POST",
          "path": "/api/purchase-orders/:id/reject",
          "body": {
            "comments": "string"
          },
          "response": {
            "order": "PurchaseOrder",
            "approval": "PurchaseOrderApproval"
          },
          "description": "Reject purchase order"
        },
        "amend": {
          "method": "POST",
          "path": "/api/purchase-orders/:id/amend",
          "body": {
            "reason": "string",
            "changes": "PurchaseOrderAmendmentInput"
          },
          "response": {
            "amendment": "PurchaseOrderAmendment"
          },
          "description": "Request purchase order amendment"
        },
        "duplicate": {
          "method": "POST",
          "path": "/api/purchase-orders/:id/duplicate",
          "body": {
            "supplierId": "uuid?",
            "requiredDate": "date?"
          },
          "response": {
            "order": "PurchaseOrder",
            "items": "PurchaseOrderItem[]"
          },
          "description": "Duplicate purchase order"
        }
      },
      "receipts": {
        "create": {
          "method": "POST",
          "path": "/api/purchase-orders/:orderId/receipts",
          "body": {
            "carrier": "string?",
            "trackingNumber": "string?",
            "items": "ReceiptItemInput[]",
            "qualityNotes": "string?"
          },
          "response": {
            "receipt": "PurchaseOrderReceipt",
            "items": "PurchaseOrderReceiptItem[]"
          },
          "description": "Record goods receipt for purchase order"
        },
        "get": {
          "method": "GET",
          "path": "/api/purchase-orders/:orderId/receipts",
          "response": {
            "receipts": "PurchaseOrderReceipt[]"
          },
          "description": "Get receipts for purchase order"
        },
        "updateQuality": {
          "method": "PUT",
          "path": "/api/receipts/:id/quality",
          "body": {
            "status": "ReceiptStatus",
            "qualityNotes": "string?",
            "items": "QualityUpdateInput[]"
          },
          "response": {
            "receipt": "PurchaseOrderReceipt"
          },
          "description": "Update receipt quality inspection results"
        }
      },
      "pricing": {
        "getSupplierPrices": {
          "method": "GET",
          "path": "/api/suppliers/:supplierId/prices",
          "query_params": [
            "productId",
            "effectiveDate"
          ],
          "response": {
            "prices": "SupplierPriceList[]"
          },
          "description": "Get supplier price list"
        },
        "setSupplierPrice": {
          "method": "POST",
          "path": "/api/suppliers/:supplierId/prices",
          "body": {
            "productId": "uuid",
            "price": "number",
            "minQuantity": "number?",
            "effectiveDate": "date?",
            "expiryDate": "date?"
          },
          "response": {
            "price": "SupplierPriceList"
          },
          "description": "Set supplier product pricing"
        },
        "getProductPrice": {
          "method": "GET",
          "path": "/api/products/:productId/supplier-price",
          "query_params": [
            "supplierId",
            "quantity",
            "date"
          ],
          "response": {
            "price": "number",
            "supplierId": "uuid",
            "tier": "SupplierPriceList?"
          },
          "description": "Get best available price for product from supplier"
        }
      },
      "approvalRules": {
        "list": {
          "method": "GET",
          "path": "/api/approval-rules",
          "response": {
            "rules": "PurchaseOrderApprovalRule[]"
          },
          "description": "Get approval rules configuration"
        },
        "create": {
          "method": "POST",
          "path": "/api/approval-rules",
          "body": {
            "name": "string",
            "minAmount": "number",
            "maxAmount": "number?",
            "approverRoles": "string[]",
            "escalationHours": "number?"
          },
          "response": {
            "rule": "PurchaseOrderApprovalRule"
          },
          "description": "Create approval rule"
        },
        "update": {
          "method": "PUT",
          "path": "/api/approval-rules/:id",
          "body": {
            "name": "string?",
            "approverRoles": "string[]?",
            "isActive": "boolean?"
          },
          "response": {
            "rule": "PurchaseOrderApprovalRule"
          },
          "description": "Update approval rule"
        }
      },
      "analytics": {
        "supplierPerformance": {
          "method": "GET",
          "path": "/api/analytics/supplier-performance",
          "query_params": [
            "supplierId",
            "dateFrom",
            "dateTo"
          ],
          "response": {
            "performance": "SupplierPerformanceMetrics[]",
            "trends": "PerformanceTrend[]",
            "rankings": "SupplierRanking[]"
          },
          "description": "Get supplier performance analytics"
        },
        "procurementMetrics": {
          "method": "GET",
          "path": "/api/analytics/procurement",
          "query_params": [
            "dateFrom",
            "dateTo",
            "supplierId"
          ],
          "response": {
            "orderVolume": "number",
            "orderValue": "number",
            "avgLeadTime": "number",
            "onTimeDeliveryRate": "number",
            "costSavings": "number",
            "supplierDiversity": "SupplierDiversityMetrics"
          },
          "description": "Get procurement performance metrics"
        },
        "spendAnalysis": {
          "method": "GET",
          "path": "/api/analytics/spend",
          "query_params": [
            "dateFrom",
            "dateTo",
            "category",
            "supplierId"
          ],
          "response": {
            "totalSpend": "number",
            "spendBySupplier": "SpendBySupplier[]",
            "spendByCategory": "SpendByCategory[]",
            "spendTrends": "SpendTrend[]"
          },
          "description": "Get procurement spend analysis"
        }
      }
    },
    "ui_components": {
      "supplierDirectory": {
        "description": "Comprehensive supplier management interface",
        "listView": {
          "columns": [
            "Code",
            "Name",
            "Type",
            "Status",
            "Rating",
            "Lead Time",
            "Last Order"
          ],
          "filters": [
            "status",
            "type",
            "rating",
            "performance"
          ],
          "actions": [
            "view",
            "edit",
            "deactivate",
            "view orders",
            "performance"
          ],
          "sorting": [
            "name",
            "rating",
            "lastOrder",
            "totalValue"
          ]
        },
        "detailView": {
          "tabs": [
            "Overview",
            "Performance",
            "Pricing",
            "Orders",
            "Contacts",
            "Documents"
          ],
          "overview": [
            "basic info",
            "contact details",
            "performance summary",
            "recent activity"
          ],
          "performance": [
            "rating trends",
            "delivery metrics",
            "quality scores",
            "comparison charts"
          ],
          "pricing": [
            "price lists",
            "agreements",
            "discounts",
            "cost history"
          ]
        },
        "creationForm": {
          "steps": [
            "Basic Info",
            "Contact Details",
            "Supplier Type",
            "Payment Terms",
            "Review"
          ],
          "validation": [
            "unique codes",
            "valid contacts",
            "required fields"
          ],
          "defaults": [
            "standard payment terms",
            "default currency"
          ]
        }
      },
      "purchaseOrderManagement": {
        "description": "Complete purchase order lifecycle interface",
        "listView": {
          "columns": [
            "PO #",
            "Supplier",
            "Date",
            "Status",
            "Value",
            "Delivery",
            "Actions"
          ],
          "filters": [
            "status",
            "supplier",
            "date range",
            "value range",
            "overdue"
          ],
          "bulkActions": [
            "approve",
            "print",
            "export",
            "cancel"
          ],
          "statusIndicators": [
            "draft",
            "pending approval",
            "approved",
            "ordered",
            "received"
          ]
        },
        "detailView": {
          "tabs": [
            "Overview",
            "Items",
            "Approvals",
            "Receipts",
            "Amendments",
            "Costs",
            "Documents"
          ],
          "overview": [
            "header info",
            "status timeline",
            "key metrics",
            "quick actions"
          ],
          "items": [
            "line items table",
            "add/edit items",
            "quantity tracking",
            "pricing"
          ],
          "approvals": [
            "approval workflow",
            "status history",
            "comments",
            "escalation"
          ]
        },
        "creationWizard": {
          "steps": [
            "Select Supplier",
            "Add Items",
            "Configure Terms",
            "Review & Submit"
          ],
          "features": [
            "supplier search",
            "product catalog integration",
            "bulk item import",
            "approval preview"
          ],
          "validation": [
            "supplier credit check",
            "item availability",
            "approval requirements"
          ]
        }
      },
      "approvalWorkflow": {
        "description": "Multi-level purchase order approval system",
        "dashboard": {
          "widgets": [
            "pending approvals",
            "approval queue",
            "escalated items",
            "approval metrics"
          ],
          "filters": [
            "by role",
            "by amount",
            "by supplier",
            "by urgency"
          ]
        },
        "approvalInterface": {
          "orderSummary": [
            "key details",
            "item breakdown",
            "approval history"
          ],
          "decisionPanel": [
            "approve/reject buttons",
            "comments field",
            "escalation option"
          ],
          "rulesDisplay": [
            "applicable rules",
            "approval requirements",
            "authority levels"
          ]
        },
        "rulesManagement": {
          "ruleEditor": [
            "amount thresholds",
            "approver roles",
            "escalation rules"
          ],
          "ruleTesting": [
            "rule validation",
            "scenario testing",
            "impact analysis"
          ]
        }
      },
      "goodsReceipt": {
        "description": "Quality-controlled goods receipt system",
        "receiptInterface": {
          "orderSelection": [
            "PO lookup",
            "item verification",
            "quantity checking"
          ],
          "qualityInspection": [
            "condition assessment",
            "damage reporting",
            "quality notes"
          ],
          "receiptRecording": [
            "quantity received",
            "rejection reasons",
            "batch/lot tracking"
          ]
        },
        "receiptHistory": {
          "timelineView": [
            "receipt events",
            "quality status",
            "user actions"
          ],
          "itemTracking": [
            "received vs ordered",
            "rejection analysis",
            "backorder status"
          ]
        },
        "qualityDashboard": {
          "metrics": [
            "rejection rates",
            "quality trends",
            "supplier performance"
          ],
          "reports": [
            "quality incidents",
            "corrective actions",
            "improvement plans"
          ]
        }
      },
      "procurementDashboard": {
        "description": "Executive procurement overview and analytics",
        "widgets": [
          {
            "name": "Spend Overview",
            "metrics": [
              "MTD spend",
              "YTD spend",
              "budget vs actual"
            ]
          },
          {
            "name": "Order Status",
            "charts": [
              "status breakdown",
              "order volume trends"
            ]
          },
          {
            "name": "Supplier Performance",
            "rankings": [
              "top suppliers",
              "performance scores"
            ]
          },
          {
            "name": "Approval Queue",
            "alerts": [
              "pending approvals",
              "overdue items"
            ]
          }
        ],
        "drillDowns": [
          "spend by supplier",
          "orders by status",
          "performance trends"
        ],
        "alerts": [
          "low stock alerts",
          "approval escalations",
          "supplier issues"
        ]
      },
      "supplierOnboarding": {
        "description": "Streamlined supplier registration and qualification",
        "onboardingFlow": {
          "steps": [
            "Basic Information",
            "Qualification",
            "Documentation",
            "Approval"
          ],
          "requirements": [
            "tax ID",
            "insurance certificates",
            "quality certifications"
          ],
          "validation": [
            "duplicate checking",
            "document verification",
            "compliance review"
          ]
        },
        "qualificationCriteria": {
          "scoring": [
            "quality certifications",
            "financial stability",
            "capacity assessment"
          ],
          "categories": [
            "preferred",
            "approved",
            "probationary",
            "disqualified"
          ]
        }
      },
      "procurementReports": {
        "description": "Comprehensive procurement analytics and reporting",
        "reportTypes": [
          {
            "name": "Spend Analysis",
            "metrics": [
              "by supplier",
              "by category",
              "by time period"
            ]
          },
          {
            "name": "Supplier Performance",
            "metrics": [
              "quality scores",
              "delivery rates",
              "cost trends"
            ]
          },
          {
            "name": "Order Analytics",
            "metrics": [
              "order volume",
              "lead times",
              "approval rates"
            ]
          },
          {
            "name": "Cost Savings",
            "metrics": [
              "negotiated savings",
              "volume discounts",
              "process improvements"
            ]
          }
        ],
        "exportOptions": [
          "PDF reports",
          "Excel exports",
          "scheduled email delivery"
        ],
        "customReports": [
          "report builder",
          "saved reports",
          "dashboard integration"
        ]
      }
    },
    "business_rules": {
      "supplier_lifecycle": {
        "onboarding": "Suppliers registered with qualification assessment and approval workflow",
        "qualification": "Suppliers categorized by performance, capacity, and compliance status",
        "monitoring": "Ongoing performance tracking with automated alerts and review cycles",
        "termination": "Supplier deactivation with order transition and final settlement procedures"
      },
      "purchase_order_workflow": {
        "creation": "POs created with supplier selection, item specification, and delivery requirements",
        "validation": "PO validation including supplier credit limits, item availability, and approval rules",
        "approval": "Multi-level approval based on order value, supplier risk, and organizational policies",
        "fulfillment": "Order transmission to supplier with tracking and delivery coordination",
        "receipt": "Quality-controlled goods receipt with inspection and acceptance procedures",
        "closure": "PO closure with final reconciliation and performance feedback"
      },
      "approval_routing": {
        "rule_based": "Approvals routed based on order value, supplier category, and item criticality",
        "hierarchical": "Multi-level approvals with escalation procedures for delayed responses",
        "exception_handling": "Emergency approval procedures for urgent business requirements",
        "audit_trail": "Complete approval history with timestamps, comments, and user attribution"
      },
      "supplier_performance": {
        "metrics_calculation": "Automated calculation of delivery time, quality ratings, and cost performance",
        "threshold_alerts": "Configurable alert thresholds for performance degradation",
        "performance_reviews": "Scheduled performance reviews with improvement action plans",
        "scorecard_updates": "Real-time scorecard updates with trend analysis and forecasting"
      },
      "pricing_management": {
        "price_agreements": "Negotiated pricing agreements with effective dates and expiration",
        "volume_discounts": "Tiered pricing based on order quantity and purchase volume",
        "price_optimization": "Automated price comparison and negotiation support",
        "cost_tracking": "Landed cost calculation including freight, duties, and handling fees"
      },
      "quality_assurance": {
        "receipt_inspection": "Mandatory quality inspection for incoming goods",
        "defect_tracking": "Detailed defect categorization and root cause analysis",
        "supplier_feedback": "Quality issues communicated to suppliers with corrective action requests",
        "quality_metrics": "Defect rates, acceptance rates, and quality trend analysis"
      },
      "inventory_integration": {
        "stock_updates": "Automatic inventory updates upon goods receipt",
        "backorder_management": "Backorder creation and fulfillment from purchase receipts",
        "stock_allocation": "Stock reservation and allocation for pending orders",
        "cost_calculation": "Weighted average cost updates with landed cost inclusion"
      },
      "financial_integration": {
        "invoice_matching": "PO-based invoice verification and three-way matching",
        "payment_processing": "Automated payment scheduling based on payment terms",
        "budget_tracking": "Purchase budget monitoring and spending controls",
        "tax_compliance": "Tax calculation and reporting for procurement transactions"
      }
    },
    "integrations": {
      "inventory_system": {
        "stock_level_updates": "Real-time inventory adjustments from purchase receipts",
        "allocation_management": "Stock allocation for pending purchase orders",
        "backorder_processing": "Automatic backorder fulfillment from receipts",
        "cost_price_updates": "Weighted average cost calculation with landed costs"
      },
      "financial_system": {
        "invoice_processing": "Purchase invoice creation and approval workflow",
        "payment_scheduling": "Automated payment processing based on terms",
        "budget_monitoring": "Purchase budget tracking and variance reporting",
        "tax_calculation": "GST and tax calculation for procurement transactions"
      },
      "product_system": {
        "catalog_integration": "Real-time product information for PO creation",
        "pricing_retrieval": "Supplier-specific pricing for line item costing",
        "specification_access": "Product specifications for quality verification",
        "vendor_part_numbers": "Supplier-specific part number mapping"
      },
      "communication_system": {
        "email_notifications": "Automated emails for approvals, receipts, and status updates",
        "supplier_communication": "Purchase order transmission and amendment notifications",
        "approval_alerts": "Real-time notifications for pending approvals and escalations",
        "document_sharing": "Secure document exchange with suppliers"
      },
      "analytics_system": {
        "performance_tracking": "Supplier performance metrics and trend analysis",
        "spend_analytics": "Procurement spend analysis and cost optimization",
        "forecasting": "Demand forecasting and reorder point optimization",
        "compliance_reporting": "Regulatory compliance and audit reporting"
      },
      "document_system": {
        "po_generation": "Professional purchase order document creation",
        "receipt_documents": "Goods receipt documentation and quality reports",
        "supplier_documents": "Contract storage and supplier qualification documents",
        "audit_trail": "Document version control and access logging"
      }
    },
    "performance_requirements": {
      "response_times": {
        "supplier_search": "< 200 milliseconds",
        "po_creation": "< 1 second",
        "approval_submission": "< 500 milliseconds",
        "receipt_recording": "< 2 seconds",
        "analytics_queries": "< 3 seconds"
      },
      "scalability": {
        "concurrent_users": "50+ simultaneous procurement users",
        "supplier_database": "1000+ active suppliers",
        "purchase_orders": "10000+ monthly orders",
        "receipt_processing": "1000+ daily receipts",
        "analytics_queries": "100+ concurrent report users"
      },
      "reliability": {
        "uptime_target": "99.9% availability for procurement operations",
        "data_durability": "100% procurement data durability",
        "backup_frequency": "Daily automated backups",
        "disaster_recovery": "4-hour RTO, 1-hour RPO for critical procurement",
        "audit_compliance": "100% audit trail completeness"
      },
      "data_processing": {
        "batch_imports": "1000+ products per import job",
        "bulk_operations": "100+ purchase orders per bulk operation",
        "report_generation": "Large datasets processed within 5 minutes",
        "search_performance": "Sub-second search across all procurement data"
      }
    }
  },
  "stories": [
    {
      "id": "SUPP-CORE-SCHEMA",
      "name": "Supplier Management Core Schema",
      "description": "Create complete supplier relationship management database schema",
      "type": "schema",
      "acceptance_criteria": [
        "Complete suppliers table with performance tracking fields",
        "purchaseOrders and purchaseOrderItems tables with full lifecycle",
        "Approval workflow tables (approvals, rules)",
        "Supplier performance metrics and price lists",
        "Goods receipt and quality control tables",
        "Amendment and cost tracking tables",
        "All foreign key relationships and proper indexing",
        "RLS policies for organization data isolation",
        "TypeScript types exported for all entities"
      ],
      "files_to_modify": [
        "src/lib/schema/suppliers.ts",
        "src/lib/schema/purchase-orders.ts",
        "src/lib/schema/purchase-order-approvals.ts",
        "src/lib/schema/supplier-performance.ts",
        "src/lib/schema/supplier-pricing.ts",
        "src/lib/schema/purchase-receipts.ts",
        "src/lib/schema/purchase-amendments.ts",
        "src/lib/schema/purchase-costs.ts",
        "src/lib/schema/index.ts",
        "drizzle/migrations/010_suppliers.ts"
      ],
      "_schema_note": "Depends on 008_products.ts for products table. purchaseOrderItems.productId and supplierPriceLists.productId reference products(id).",
      "completion_promise": "SUPP_CORE_SCHEMA_COMPLETE",
      "estimated_iterations": 2,
      "uiPatterns": {
        "primary": [],
        "secondary": [],
        "notes": "Schema-only story - no UI patterns required"
      },
      "status": "pending"
    },
    {
      "id": "SUPP-CORE-API",
      "name": "Supplier Management Core API",
      "description": "Implement comprehensive supplier and procurement operations",
      "type": "server-function",
      "acceptance_criteria": [
        "Complete supplier CRUD with performance tracking",
        "Full purchase order lifecycle management",
        "Approval workflow API with escalation",
        "Supplier pricing and performance APIs",
        "Goods receipt and quality control endpoints",
        "Amendment and cost tracking operations",
        "All endpoints include proper error handling and RLS",
        "Comprehensive Zod validation schemas"
      ],
      "files_to_modify": [
        "src/server/functions/suppliers.ts",
        "src/server/functions/purchase-orders.ts",
        "src/server/functions/approvals.ts",
        "src/server/functions/receipts.ts",
        "src/server/functions/supplier-analytics.ts",
        "src/lib/schemas/suppliers.ts"
      ],
      "dependencies": [
        "SUPP-CORE-SCHEMA"
      ],
      "completion_promise": "SUPP_CORE_API_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [],
        "secondary": [],
        "notes": "Server-function story - no UI patterns required"
      },
      "status": "pending"
    },
    {
      "id": "SUPP-SUPPLIER-DIRECTORY",
      "name": "Supplier Directory Interface",
      "description": "Comprehensive supplier management and performance tracking",
      "type": "ui-component",
      "acceptance_criteria": [
        "Responsive supplier list with advanced filtering",
        "Supplier detail view with performance metrics",
        "Supplier creation and qualification workflow",
        "Performance dashboard with trend analysis",
        "Supplier communication and document management",
        "Bulk supplier operations and reporting"
      ],
      "files_to_modify": [
        "src/routes/_authed/suppliers/index.tsx",
        "src/routes/_authed/suppliers/$supplierId.tsx",
        "src/components/domain/suppliers/supplier-list.tsx",
        "src/components/domain/suppliers/supplier-detail.tsx",
        "src/components/domain/suppliers/supplier-form.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_SUPPLIER_DIRECTORY_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "DataGrid",
            "source": "RE-UI",
            "usage": "Supplier list table with sortable columns, filtering, and pagination",
            "features": [
              "sorting",
              "column visibility",
              "row selection",
              "bulk actions"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Filters",
            "source": "RE-UI",
            "usage": "Advanced supplier filtering by status, type, rating, and performance",
            "features": [
              "multiple conditions",
              "operators",
              "visual indicators",
              "clear all"
            ],
            "reference": "_reference/.reui-reference/public/docs/filters.md"
          },
          {
            "pattern": "Tabs",
            "source": "RE-UI",
            "usage": "Detail view tabs for Overview, Performance, Pricing, Orders, Contacts, Documents",
            "features": [
              "keyboard navigation",
              "lazy loading"
            ],
            "reference": "_reference/.reui-reference/public/docs/base-tabs.md"
          }
        ],
        "secondary": [
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Status indicators (active/inactive/suspended/blacklisted)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Rating",
            "source": "RE-UI",
            "usage": "Display and edit supplier performance ratings (quality, delivery, communication)",
            "reference": "_reference/.reui-reference/public/docs/rating.md"
          },
          {
            "pattern": "Card",
            "source": "RE-UI",
            "usage": "Summary cards for key supplier metrics",
            "reference": "_reference/.reui-reference/public/docs/card.md"
          },
          {
            "pattern": "Command",
            "source": "RE-UI",
            "usage": "Quick search and navigation for suppliers",
            "reference": "_reference/.reui-reference/public/docs/command.md"
          }
        ],
        "notes": "Emphasize data-dense views with performance indicators. Consider using Chart components for performance trends."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-PO-MANAGEMENT",
      "name": "Purchase Order Management Interface",
      "description": "Complete purchase order lifecycle management",
      "type": "ui-component",
      "acceptance_criteria": [
        "PO list with comprehensive filtering and bulk actions",
        "PO creation wizard with supplier and item selection",
        "PO detail view with full lifecycle tracking",
        "Approval workflow interface with escalation",
        "Amendment request and approval process",
        "PO printing and document generation"
      ],
      "files_to_modify": [
        "src/routes/_authed/purchase-orders/index.tsx",
        "src/routes/_authed/purchase-orders/$poId.tsx",
        "src/components/domain/purchase-orders/po-list.tsx",
        "src/components/domain/purchase-orders/po-detail.tsx",
        "src/components/domain/purchase-orders/po-creation-wizard.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_PO_MANAGEMENT_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "DataGrid",
            "source": "RE-UI",
            "usage": "PO list with status, supplier, dates, amounts, and actions",
            "features": [
              "sorting",
              "filtering",
              "bulk selection",
              "status badges"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Dialog (Multi-step)",
            "source": "RE-UI",
            "usage": "PO creation wizard: Select Supplier > Add Items > Configure Terms > Review",
            "features": [
              "step validation",
              "progress indicator",
              "draft saving"
            ],
            "reference": "_reference/.reui-reference/public/docs/base-dialog.md"
          },
          {
            "pattern": "Tabs",
            "source": "RE-UI",
            "usage": "PO detail tabs: Overview, Items, Approvals, Receipts, Amendments, Costs, Documents",
            "reference": "_reference/.reui-reference/public/docs/base-tabs.md"
          },
          {
            "pattern": "Timeline",
            "source": "Midday",
            "usage": "Visual PO lifecycle timeline showing status transitions and approvals",
            "reference": "_reference/.midday-reference/"
          }
        ],
        "secondary": [
          {
            "pattern": "Combobox",
            "source": "RE-UI",
            "usage": "Supplier and product selection with search",
            "reference": "_reference/.reui-reference/public/docs/combobox.md"
          },
          {
            "pattern": "DataGrid (nested)",
            "source": "RE-UI",
            "usage": "Line items table with inline editing",
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "PO status indicators (draft, pending, approved, ordered, received)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Alert",
            "source": "RE-UI",
            "usage": "Validation messages and approval requirements",
            "reference": "_reference/.reui-reference/public/docs/alert.md"
          }
        ],
        "notes": "Focus on workflow clarity and status visibility. Wizard should guide users through complex multi-step process."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-APPROVAL-WORKFLOW",
      "name": "Approval Workflow System",
      "description": "Multi-level purchase order approval and routing",
      "type": "ui-component",
      "acceptance_criteria": [
        "Approval dashboard with pending queue",
        "Rule-based approval routing configuration",
        "Approval decision interface with comments",
        "Escalation management and notifications",
        "Approval history and audit trail",
        "Bulk approval operations"
      ],
      "files_to_modify": [
        "src/routes/_authed/approvals/index.tsx",
        "src/components/domain/approvals/approval-dashboard.tsx",
        "src/components/domain/approvals/approval-rules.tsx",
        "src/components/domain/approvals/approval-decision.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_APPROVAL_WORKFLOW_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "DataGrid",
            "source": "RE-UI",
            "usage": "Approval queue with pending items, urgency indicators, and bulk actions",
            "features": [
              "priority sorting",
              "status filters",
              "bulk approve/reject"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Sheet",
            "source": "RE-UI",
            "usage": "Approval decision panel with PO summary and decision controls",
            "features": [
              "comments",
              "approve/reject/escalate buttons"
            ],
            "reference": "_reference/.reui-reference/public/docs/base-sheet.md"
          },
          {
            "pattern": "Timeline",
            "source": "Midday",
            "usage": "Approval history showing decision sequence and timestamps",
            "reference": "_reference/.midday-reference/"
          }
        ],
        "secondary": [
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Approval status (pending, approved, rejected, escalated)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Alert Dialog",
            "source": "RE-UI",
            "usage": "Confirm bulk approval/rejection actions",
            "reference": "_reference/.reui-reference/public/docs/alert-dialog.md"
          },
          {
            "pattern": "Form",
            "source": "RE-UI",
            "usage": "Approval rule configuration with validation",
            "reference": "_reference/.reui-reference/public/docs/form.md"
          },
          {
            "pattern": "Textarea",
            "source": "RE-UI",
            "usage": "Comments field for approval decisions",
            "reference": "_reference/.reui-reference/public/docs/textarea.md"
          }
        ],
        "notes": "Emphasize urgency and decision-making speed. Use color coding for escalations and overdue items."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-GOODS-RECEIPT",
      "name": "Goods Receipt System",
      "description": "Quality-controlled goods receipt and inspection",
      "type": "ui-component",
      "acceptance_criteria": [
        "Receipt creation interface with item verification",
        "Quality inspection workflow with defect tracking",
        "Partial receipt handling and backorder management",
        "Receipt history and audit trail",
        "Quality metrics and reporting",
        "Supplier feedback integration"
      ],
      "files_to_modify": [
        "src/components/domain/receipts/receipt-creation.tsx",
        "src/components/domain/receipts/quality-inspection.tsx",
        "src/components/domain/receipts/receipt-history.tsx",
        "src/components/domain/receipts/quality-dashboard.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_GOODS_RECEIPT_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "Dialog (Multi-step)",
            "source": "RE-UI",
            "usage": "Receipt creation: PO Lookup > Item Verification > Quality Inspection > Confirm",
            "reference": "_reference/.reui-reference/public/docs/base-dialog.md"
          },
          {
            "pattern": "DataGrid",
            "source": "RE-UI",
            "usage": "Line items with received/accepted/rejected quantities",
            "features": [
              "inline editing",
              "quantity validation"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Timeline",
            "source": "Midday",
            "usage": "Receipt history showing events, quality checks, and user actions",
            "reference": "_reference/.midday-reference/"
          }
        ],
        "secondary": [
          {
            "pattern": "Select",
            "source": "RE-UI",
            "usage": "Rejection reason dropdown (damaged, wrong_item, quality_issue, etc.)",
            "reference": "_reference/.reui-reference/public/docs/select.md"
          },
          {
            "pattern": "Checkbox",
            "source": "RE-UI",
            "usage": "Quality check passed/failed indicators",
            "reference": "_reference/.reui-reference/public/docs/checkbox.md"
          },
          {
            "pattern": "Input",
            "source": "RE-UI",
            "usage": "Quantity fields with validation",
            "reference": "_reference/.reui-reference/public/docs/input.md"
          },
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Receipt status (pending_inspection, accepted, partially_accepted, rejected)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Progress",
            "source": "RE-UI",
            "usage": "Visual indicator of quantity received vs ordered",
            "reference": "_reference/.reui-reference/public/docs/progress.md"
          }
        ],
        "notes": "Focus on mobile-friendly design for warehouse operations. Emphasize data accuracy and validation."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-PRICING-MANAGEMENT",
      "name": "Supplier Pricing Management",
      "description": "Supplier-specific pricing and agreement management",
      "type": "ui-component",
      "acceptance_criteria": [
        "Supplier price list management",
        "Volume discount configuration",
        "Price comparison across suppliers",
        "Price agreement tracking and expiration",
        "Bulk price updates and imports",
        "Price change history and approval"
      ],
      "files_to_modify": [
        "src/components/domain/suppliers/pricing-management.tsx",
        "src/components/domain/suppliers/price-comparison.tsx",
        "src/components/domain/suppliers/price-agreements.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_PRICING_MANAGEMENT_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "DataGrid",
            "source": "RE-UI",
            "usage": "Price list table with products, tiers, effective dates, and actions",
            "features": [
              "inline editing",
              "bulk updates",
              "export"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Dialog",
            "source": "RE-UI",
            "usage": "Price agreement creation/editing with date range and discount tiers",
            "reference": "_reference/.reui-reference/public/docs/base-dialog.md"
          },
          {
            "pattern": "DataGrid (comparison)",
            "source": "RE-UI",
            "usage": "Side-by-side price comparison across suppliers for same product",
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          }
        ],
        "secondary": [
          {
            "pattern": "Date Picker",
            "source": "RE-UI",
            "usage": "Effective date and expiry date selection",
            "reference": "_reference/.reui-reference/public/docs/date-picker.md"
          },
          {
            "pattern": "Input (currency)",
            "source": "RE-UI",
            "usage": "Price fields with currency formatting",
            "reference": "_reference/.reui-reference/public/docs/input.md"
          },
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Price status (active, expired, preferred)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Alert",
            "source": "RE-UI",
            "usage": "Expiring price agreements warnings",
            "reference": "_reference/.reui-reference/public/docs/alert.md"
          }
        ],
        "notes": "Emphasize price comparison and volume discount visualization. Consider using Charts for price history trends."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-PROCUREMENT-DASHBOARD",
      "name": "Procurement Operations Dashboard",
      "description": "Executive procurement overview and real-time monitoring",
      "type": "ui-component",
      "acceptance_criteria": [
        "Comprehensive procurement metrics widgets",
        "Real-time order status and approval tracking",
        "Supplier performance overview",
        "Spend analysis and budget monitoring",
        "Procurement alerts and notifications",
        "Interactive drill-down capabilities"
      ],
      "files_to_modify": [
        "src/routes/_authed/procurement/dashboard.tsx",
        "src/components/domain/procurement/dashboard-widgets.tsx",
        "src/components/domain/procurement/procurement-alerts.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_PROCUREMENT_DASHBOARD_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "Card (Dashboard Widget)",
            "source": "RE-UI",
            "usage": "Metric cards for spend overview, order status, supplier performance, approval queue",
            "features": [
              "interactive",
              "drill-down links"
            ],
            "reference": "_reference/.reui-reference/public/docs/card.md"
          },
          {
            "pattern": "Chart",
            "source": "RE-UI",
            "usage": "Spend trends, order volume, performance rankings",
            "features": [
              "line charts",
              "bar charts",
              "pie charts"
            ],
            "reference": "_reference/.reui-reference/public/docs/chart.md"
          },
          {
            "pattern": "DataGrid (embedded)",
            "source": "RE-UI",
            "usage": "Top suppliers table, pending approvals list",
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          }
        ],
        "secondary": [
          {
            "pattern": "Alert",
            "source": "RE-UI",
            "usage": "Procurement alerts (low stock, approval escalations, supplier issues)",
            "reference": "_reference/.reui-reference/public/docs/alert.md"
          },
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Alert counts and status indicators",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Popover",
            "source": "RE-UI",
            "usage": "Quick metric details on hover",
            "reference": "_reference/.reui-reference/public/docs/popover.md"
          },
          {
            "pattern": "Filters",
            "source": "RE-UI",
            "usage": "Date range and supplier filters for dashboard data",
            "reference": "_reference/.reui-reference/public/docs/filters.md"
          }
        ],
        "notes": "Focus on executive summary with actionable insights. Use Midday's dashboard patterns for layout inspiration."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-ANALYTICS-REPORTING",
      "name": "Procurement Analytics and Reporting",
      "description": "Advanced procurement analytics and automated reporting",
      "type": "ui-component",
      "acceptance_criteria": [
        "Supplier performance analytics and trends",
        "Spend analysis by category and supplier",
        "Procurement efficiency metrics",
        "Cost savings tracking and reporting",
        "Automated report generation and scheduling",
        "Custom report builder and dashboard integration"
      ],
      "files_to_modify": [
        "src/routes/_authed/reports/procurement/index.tsx",
        "src/components/domain/reports/supplier-performance.tsx",
        "src/components/domain/reports/spend-analysis.tsx",
        "src/components/domain/reports/procurement-metrics.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_ANALYTICS_REPORTING_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "Chart",
            "source": "RE-UI",
            "usage": "Multi-dimensional charts for spend analysis, performance trends, cost savings",
            "features": [
              "line",
              "bar",
              "pie",
              "radar charts",
              "interactive legends"
            ],
            "reference": "_reference/.reui-reference/public/docs/chart.md"
          },
          {
            "pattern": "DataGrid",
            "source": "RE-UI",
            "usage": "Detailed report tables with export functionality",
            "features": [
              "sorting",
              "filtering",
              "export to CSV/Excel"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Tabs",
            "source": "RE-UI",
            "usage": "Report type tabs: Spend Analysis, Supplier Performance, Order Analytics, Cost Savings",
            "reference": "_reference/.reui-reference/public/docs/base-tabs.md"
          }
        ],
        "secondary": [
          {
            "pattern": "Filters",
            "source": "RE-UI",
            "usage": "Date range, supplier, category filters for reports",
            "reference": "_reference/.reui-reference/public/docs/filters.md"
          },
          {
            "pattern": "Select",
            "source": "RE-UI",
            "usage": "Report template selection and time period grouping",
            "reference": "_reference/.reui-reference/public/docs/select.md"
          },
          {
            "pattern": "Dialog",
            "source": "RE-UI",
            "usage": "Custom report builder configuration",
            "reference": "_reference/.reui-reference/public/docs/base-dialog.md"
          },
          {
            "pattern": "Button",
            "source": "RE-UI",
            "usage": "Export actions (PDF, Excel, Email)",
            "reference": "_reference/.reui-reference/public/docs/button.md"
          }
        ],
        "notes": "Prioritize data visualization and export capabilities. Consider using Midday's reporting patterns for inspiration."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-INTEGRATION-API",
      "name": "Supplier System Integration Layer",
      "description": "Integration hooks and utilities for supplier system usage",
      "type": "server-function",
      "acceptance_criteria": [
        "Supplier context providers for React components",
        "Approval workflow integration hooks",
        "Supplier performance calculation utilities",
        "Purchase order lifecycle event handlers",
        "Receipt processing automation",
        "Audit logging integration for all supplier operations",
        "Real-time notification broadcasting"
      ],
      "files_to_modify": [
        "src/contexts/supplier-context.tsx",
        "src/hooks/use-suppliers.ts",
        "src/hooks/use-purchase-orders.ts",
        "src/lib/supplier-utils.ts",
        "src/lib/approval-workflow.ts"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_INTEGRATION_API_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [],
        "secondary": [],
        "notes": "Server-function/integration story - no UI patterns required"
      },
      "status": "pending"
    },
    {
      "id": "SUPP-ONBOARDING-WORKFLOW",
      "name": "Supplier Onboarding Workflow",
      "description": "Streamlined supplier registration and qualification",
      "type": "ui-component",
      "acceptance_criteria": [
        "Supplier registration form with qualification criteria",
        "Document upload and verification workflow",
        "Qualification scoring and approval process",
        "Onboarding checklist and progress tracking",
        "Supplier portal access provisioning",
        "Automated qualification notifications"
      ],
      "files_to_modify": [
        "src/routes/_authed/suppliers/onboard.tsx",
        "src/components/domain/suppliers/onboarding-form.tsx",
        "src/components/domain/suppliers/qualification-checklist.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_ONBOARDING_WORKFLOW_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "Dialog (Multi-step)",
            "source": "RE-UI",
            "usage": "Onboarding wizard: Basic Info > Qualification > Documentation > Approval",
            "features": [
              "step validation",
              "progress indicator",
              "save draft"
            ],
            "reference": "_reference/.reui-reference/public/docs/base-dialog.md"
          },
          {
            "pattern": "Form",
            "source": "RE-UI",
            "usage": "Comprehensive registration form with validation",
            "features": [
              "react-hook-form",
              "zod validation"
            ],
            "reference": "_reference/.reui-reference/public/docs/form.md"
          },
          {
            "pattern": "Progress",
            "source": "RE-UI",
            "usage": "Onboarding completion progress bar",
            "reference": "_reference/.reui-reference/public/docs/progress.md"
          }
        ],
        "secondary": [
          {
            "pattern": "File Upload",
            "source": "RE-UI",
            "usage": "Document upload (tax ID, insurance, certifications)",
            "reference": "_reference/.reui-reference/public/docs/file-upload.md"
          },
          {
            "pattern": "Checkbox",
            "source": "RE-UI",
            "usage": "Qualification checklist items",
            "reference": "_reference/.reui-reference/public/docs/checkbox.md"
          },
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Qualification status (preferred, approved, probationary, disqualified)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          },
          {
            "pattern": "Alert",
            "source": "RE-UI",
            "usage": "Validation errors and qualification requirements",
            "reference": "_reference/.reui-reference/public/docs/alert.md"
          }
        ],
        "notes": "Emphasize clarity and guidance through complex onboarding process. Use progressive disclosure."
      },
      "status": "pending"
    },
    {
      "id": "SUPP-BULK-OPERATIONS",
      "name": "Bulk Procurement Operations",
      "description": "Efficient bulk operations for supplier and order management",
      "type": "ui-component",
      "acceptance_criteria": [
        "Bulk supplier data import and updates",
        "Bulk purchase order operations",
        "Bulk approval processing",
        "Bulk supplier communication",
        "Operation progress tracking and error handling",
        "Bulk operation history and rollback capabilities"
      ],
      "files_to_modify": [
        "src/components/domain/suppliers/bulk-import.tsx",
        "src/components/domain/purchase-orders/bulk-operations.tsx",
        "src/components/domain/approvals/bulk-approvals.tsx"
      ],
      "dependencies": [
        "SUPP-CORE-API"
      ],
      "completion_promise": "SUPP_BULK_OPERATIONS_COMPLETE",
      "estimated_iterations": 3,
      "uiPatterns": {
        "primary": [
          {
            "pattern": "Dialog (Multi-step)",
            "source": "RE-UI",
            "usage": "Bulk import wizard: Upload > Map Fields > Validate > Confirm",
            "reference": "_reference/.reui-reference/public/docs/base-dialog.md"
          },
          {
            "pattern": "DataGrid (selection)",
            "source": "RE-UI",
            "usage": "Bulk operation selection interface with row selection",
            "features": [
              "multi-select",
              "select all",
              "filter selection"
            ],
            "reference": "_reference/.reui-reference/public/docs/data-grid.md"
          },
          {
            "pattern": "Progress",
            "source": "RE-UI",
            "usage": "Bulk operation progress indicator with item count",
            "reference": "_reference/.reui-reference/public/docs/progress.md"
          }
        ],
        "secondary": [
          {
            "pattern": "File Upload",
            "source": "RE-UI",
            "usage": "CSV/Excel upload for bulk import",
            "reference": "_reference/.reui-reference/public/docs/file-upload.md"
          },
          {
            "pattern": "Alert Dialog",
            "source": "RE-UI",
            "usage": "Confirm bulk operations (approve 50 orders, update 100 suppliers)",
            "reference": "_reference/.reui-reference/public/docs/alert-dialog.md"
          },
          {
            "pattern": "Alert",
            "source": "RE-UI",
            "usage": "Error summary for failed operations",
            "reference": "_reference/.reui-reference/public/docs/alert.md"
          },
          {
            "pattern": "Badge",
            "source": "RE-UI",
            "usage": "Operation status (pending, processing, completed, failed)",
            "reference": "_reference/.reui-reference/public/docs/badge.md"
          }
        ],
        "notes": "Focus on progress visibility and error handling. Provide clear rollback and retry mechanisms."
      },
      "status": "pending"
    }
  ],
  "success_criteria": [
    "Complete supplier relationship management from onboarding to performance tracking",
    "End-to-end purchase order lifecycle from creation to goods receipt",
    "Multi-level approval workflow with escalation and audit trails",
    "Quality-controlled goods receipt with defect tracking and supplier feedback",
    "Supplier-specific pricing with volume discounts and agreement management",
    "Comprehensive supplier performance analytics and scorecard management",
    "Real-time procurement dashboard with alerts and drill-down capabilities",
    "Automated spend analysis and procurement cost optimization",
    "Mobile-responsive interfaces for warehouse and field operations",
    "Integration with inventory, financial, and product catalog systems",
    "Performance optimized for 1000+ suppliers and 10000+ monthly orders",
    "Complete audit trail for all procurement transactions and decisions",
    "Automated reporting and email notifications for procurement events",
    "Flexible custom fields and workflow configuration",
    "Advanced search and filtering across all procurement entities",
    "Supplier portal for order status, delivery tracking, and communication"
  ],
  "out_of_scope": [
    "Supplier self-service portal (separate system)",
    "EDI/API integration with supplier systems",
    "Advanced supplier qualification scoring algorithms",
    "Blockchain-based supplier verification",
    "Real-time supplier capacity planning",
    "Automated supplier negotiation systems",
    "Advanced forecasting and demand planning",
    "Supplier diversity and inclusion tracking",
    "Carbon footprint and sustainability scoring",
    "Multi-language supplier communication"
  ],
  "migration_notes": {
    "existing_data": "If existing supplier and purchase order data exists, migration scripts needed to transform schema to new comprehensive structure",
    "approval_workflow": "Existing approval processes need mapping to new rule-based system",
    "performance_data": "Historical supplier performance data should be migrated and recalculated",
    "pricing_agreements": "Existing supplier pricing needs transformation to new tiered structure"
  },
  "schema_dependencies": {
    "prerequisite_migrations": [
      {
        "migration": "007_inventory-core.ts",
        "provides": ["warehouseLocations", "inventoryMovements"],
        "note": "Shared inventory tables"
      },
      {
        "migration": "008_products.ts",
        "provides": ["products"],
        "note": "REQUIRED - purchaseOrderItems and supplierPriceLists reference products(id)"
      }
    ],
    "this_migration": "010_suppliers.ts",
    "fk_dependencies": [
      {
        "table": "purchaseOrderItems",
        "column": "productId",
        "references": "products(id)",
        "requires": "008_products.ts"
      },
      {
        "table": "supplierPriceLists",
        "column": "productId",
        "references": "products(id)",
        "requires": "008_products.ts"
      }
    ]
  },
  "_schema_remediation": {
    "note": "This migration (010) MUST run after 008_products.ts due to FK references to products table",
    "reason": "purchaseOrderItems and supplierPriceLists tables require products to exist first",
    "migration_order": ["007_inventory-core.ts", "008_products.ts", "010_suppliers.ts", "011_inventory.ts"],
    "reference": "_meta/remediation-schema-migrations.md"
  }
}