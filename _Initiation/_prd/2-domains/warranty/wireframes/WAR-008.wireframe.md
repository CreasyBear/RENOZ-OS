# Wireframe: DOM-WAR-008 - Warranty Analytics Enhancement

## Story Reference

- **Story ID**: DOM-WAR-008
- **Name**: Warranty Analytics Enhancement
- **PRD**: memory-bank/prd/domains/warranty.prd.json
- **Type**: UI Component
- **Component Type**: Analytics dashboard with Charts and Cards

## Overview

Enhanced warranty analytics dashboard with claims by product chart for quality insights, trend analysis over time, warranty revenue vs claims cost comparison, and export functionality. Features date range and product category filters.

## UI Patterns (Reference Implementation)

### Card Component
- **Pattern**: RE-UI Card
- **Reference**: `_reference/.reui-reference/registry/default/ui/card.tsx`
- **Features**:
  - Summary metric cards with KPI display (Total Warranties, Active Claims, Claims Rate)
  - Chart container cards for analytics visualizations
  - Responsive grid layout for metric cards

### Chart Components (Custom)
- **Pattern**: RE-UI + Recharts/Chart.js integration
- **Reference**: Custom implementation using `_reference/.reui-reference/registry/default/ui/card.tsx` as container
- **Features**:
  - Claims by product category (donut/pie chart)
  - Claims trend over time (line chart with dual axis)
  - Revenue vs claims cost (stacked bar chart)

### Select Component
- **Pattern**: RE-UI Select
- **Reference**: `_reference/.reui-reference/registry/default/ui/select.tsx`
- **Features**:
  - Date range filter dropdown (Last 7/30/90 days, This Year, Custom)
  - Product category filter selector
  - Comparison period selector (vs Previous, vs Last Year)

### Sheet Component
- **Pattern**: RE-UI Sheet
- **Reference**: `_reference/.reui-reference/registry/default/ui/sheet.tsx`
- **Features**:
  - Mobile filter drawer (bottom sheet)
  - Date range picker sheet on mobile
  - Export options drawer

### Badge Component
- **Pattern**: RE-UI Badge
- **Reference**: `_reference/.reui-reference/registry/default/ui/badge.tsx`
- **Features**:
  - Trend indicators on metric cards (+5% vs previous)
  - Active filter chips
  - Alert badges for anomalies or thresholds

---

## Mobile Wireframe (375px)

### Analytics Dashboard (Stacked Charts)

```
+=========================================+
| < Reports                          [*]  |
+-----------------------------------------+
|                                         |
|  Warranty Analytics                     |
|  Claims and coverage insights           |
|                                         |
+-----------------------------------------+
|  [Filters]                  [Export v]  |
+-----------------------------------------+
|  Last 30 days | All Categories          |
+-----------------------------------------+
|                                         |
|  +--- SUMMARY CARDS --------------------+
|  |                                     ||
|  | +--------+ +--------+ +--------+    ||
|  | |Total   | |Active  | |Claims  |    ||
|  | |Warr.   | |Claims  | |Rate    |    ||
|  | |  245   | |   12   | |  4.9%  |    ||
|  | +--------+ +--------+ +--------+    ||
|  |                                     ||
|  | +--------+ +--------+               ||
|  | |Avg Cost| |Total   |               ||
|  | |/Claim  | |Cost    |               ||
|  | | $287   | |$3,450  |               ||
|  | +--------+ +--------+               ||
|  |                                     ||
|  +-------------------------------------+|
|                                         |
+-----------------------------------------+
|                                         |
|  Claims by Product Category             |
|  +-------------------------------------+|
|  |                                     ||
|  | Kitchen    ████████████   45%  12  ||
|  | Batterys    ██████         25%   7  ||
|  | HVAC       ████           18%   5  ||
|  | Flooring   ██              8%   2  ||
|  | Other      █               4%   1  ||
|  |                                     ||
|  +-------------------------------------+|
|                                         |
+-----------------------------------------+
|                                         |
|  Claims Trend (6 months)                |
|  +-------------------------------------+|
|  |     ^                               ||
|  |  12 |        *                      ||
|  |  10 |  *    / \    *               ||
|  |   8 | / \  /   \  / \    *         ||
|  |   6 |/   \/     \/   \  / \        ||
|  |   4 |                  \/           ||
|  |   2 |                               ||
|  |     +---+---+---+---+---+---+       ||
|  |      Aug Sep Oct Nov Dec Jan       ||
|  +-------------------------------------+|
|                                         |
+-----------------------------------------+
|                                         |
|  Revenue vs Claims Cost                 |
|  +-------------------------------------+|
|  | Warranty Revenue    Extended sales  ||
|  | $12,500                             ||
|  | [█████████████████████████████████] ||
|  |                                     ||
|  | Claims Cost         Resolution cost ||
|  | $3,450                              ||
|  | [██████████]                        ||
|  |                                     ||
|  | Net Margin: $9,050 (72%)            ||
|  +-------------------------------------+|
|                                         |
+=========================================+
```

### Filter Drawer (Mobile)

```
+=========================================+
|                                         |
|  =====================================  |
|         <- drag handle                  |
|                                         |
|  Filters                          [X]   |
|  =====================================  |
|                                         |
|  Date Range                             |
|  +-------------------------------------+|
|  | ○ Last 7 days                       ||
|  | ● Last 30 days     <- Selected      ||
|  | ○ Last 90 days                      ||
|  | ○ This Year                         ||
|  | ○ Custom range                      ||
|  +-------------------------------------+|
|                                         |
|  Custom Range                           |
|  +-------------+ +-------------+        |
|  | From:       | | To:         |        |
|  | [Jan 1    ] | | [Jan 31   ] |        |
|  +-------------+ +-------------+        |
|                                         |
|  Product Category                       |
|  +-------------------------------------+|
|  | [x] All Categories                  ||
|  | [ ] Kitchen & Bath                  ||
|  | [ ] Batterys & Doors                 ||
|  | [ ] HVAC                            ||
|  | [ ] Flooring                        ||
|  +-------------------------------------+|
|                                         |
|  +-------------------------------------+|
|  |     (Clear All)    [Apply Filters]  ||
|  +-------------------------------------+|
|                                         |
+=========================================+
```

---

## Tablet Wireframe (768px)

### Analytics Dashboard (2-Column Grid)

```
+=======================================================================+
| < Reports                                                              |
+------------------------------------------------------------------------+
|                                                                        |
|  Warranty Analytics                                        [Export v]  |
|  Monitor warranty performance, claims, and costs                       |
|                                                                        |
+------------------------------------------------------------------------+
|  Date Range: [Last 30 days v]  Category: [All Categories v]            |
|  Active Filters: [30 days x]                        [Clear All]        |
+------------------------------------------------------------------------+
|                                                                        |
|  +--- SUMMARY METRICS -------------------------------------------------+
|  |                                                                     |
|  |  +-----------+ +-----------+ +-----------+ +-----------+ +--------+ |
|  |  | Warranties| | Active    | | Claims    | | Avg Cost  | | Total  | |
|  |  | Registered| | Claims    | | Rate      | | per Claim | | Cost   | |
|  |  |    245    | |    12     | |   4.9%    | |   $287    | | $3,450 | |
|  |  | +5% MoM   | | -2 vs prev| |           | |           | |        | |
|  |  +-----------+ +-----------+ +-----------+ +-----------+ +--------+ |
|  |                                                                     |
|  +---------------------------------------------------------------------+
|                                                                        |
|  +--- CLAIMS BY CATEGORY ----+  +--- CLAIMS TREND -----------------+   |
|  |                           |  |                                  |   |
|  | Claims by Product         |  | Claims Over Time (6 mo)          |   |
|  | =========================  |  | ==============================  |   |
|  |                           |  |                                  |   |
|  | Kitchen  █████████ 45% 12 |  |     ^                            |   |
|  | Batterys  █████    25%  7  |  |  12 |        *                   |   |
|  | HVAC     ████     18%  5  |  |  10 |  *    / \    *            |   |
|  | Flooring ██        8%  2  |  |   8 | / \  /   \  / \    *      |   |
|  | Other    █         4%  1  |  |   6 |/   \/     \/   \  / \     |   |
|  |                           |  |   4 |                  \/        |   |
|  | Total: 27 claims          |  |   2 |                            |   |
|  |                           |  |     +--+--+--+--+--+--+          |   |
|  +---------------------------+  |      Aug Sep Oct Nov Dec Jan     |   |
|                                 +----------------------------------+   |
|                                                                        |
|  +--- REVENUE VS COST ------------------------------------------------+|
|  |                                                                    ||
|  |  Warranty Revenue                              Claims Cost         ||
|  |  ██████████████████████████████████            ████████            ||
|  |  $12,500                                       $3,450              ||
|  |                                                                    ||
|  |  Net Margin: $9,050 (72.4%)                                        ||
|  |                                                                    ||
|  +--------------------------------------------------------------------+|
|                                                                        |
+=======================================================================+
```

---

## Desktop Wireframe (1280px+)

### Full Analytics Dashboard

```
+================================================================================================+
| [Logo] Renoz CRM                                                         [Bell] [User v]       |
+----------+-------------------------------------------------------------------------------------+
|          |                                                                                      |
| Reports  |  Warranty Analytics                                            [Export to CSV]      |
| -------  |  ==================================================================================  |
| Sales    |  Comprehensive warranty performance, claims analysis, and cost insights             |
| Warranty<|                                                                                      |
| Analytic<|  +--------------------------------------------------------------------------------+  |
| Pipeline |  | FILTERS                                                                        |  |
|          |  |                                                                                |  |
|          |  |  Date Range         Category             Comparison          Export            |  |
|          |  |  [Last 30 days v]   [All Categories v]   [vs Previous v]    [CSV] [PDF]        |  |
|          |  |                                                                                |  |
|          |  +--------------------------------------------------------------------------------+  |
|          |                                                                                      |
|          |  +--- SUMMARY METRICS ROW ---------------------------------------------------+      |
|          |  |                                                                           |      |
|          |  | +---------------+ +---------------+ +---------------+ +---------------+  |      |
|          |  | | TOTAL         | | ACTIVE        | | CLAIMS        | | AVG CLAIM     |  |      |
|          |  | | WARRANTIES    | | CLAIMS        | | RATE          | | COST          |  |      |
|          |  | |     245       | |      12       | |    4.9%       | |    $287       |  |      |
|          |  | | +5% vs prev   | | -2 vs prev    | | -0.3% vs prev | | +$12 vs prev  |  |      |
|          |  | | [sparkline]   | | [sparkline]   | | [sparkline]   | | [sparkline]   |  |      |
|          |  | +---------------+ +---------------+ +---------------+ +---------------+  |      |
|          |  |                                                                           |      |
|          |  | +---------------+ +---------------+                                       |      |
|          |  | | TOTAL CLAIMS  | | WARRANTY      |                                       |      |
|          |  | | COST          | | REVENUE       |                                       |      |
|          |  | |   $3,450      | |   $12,500     |                                       |      |
|          |  | | +$450 vs prev | | +$1,200 prev  |                                       |      |
|          |  | | [sparkline]   | | [sparkline]   |                                       |      |
|          |  | +---------------+ +---------------+                                       |      |
|          |  |                                                                           |      |
|          |  +--------------------------------------------------------------------------+      |
|          |                                                                                      |
|          |  +--- CHARTS ROW ---------------------------------------------------------------+   |
|          |  |                                                                              |   |
|          |  | +--- CLAIMS BY PRODUCT ----------+  +--- CLAIMS TREND (6 MONTHS) --------+  |   |
|          |  | |                                |  |                                    |  |   |
|          |  | | Claims Distribution            |  | Monthly Claims Volume              |  |   |
|          |  | | by Category                    |  |                                    |  |   |
|          |  | |                                |  |       ^                            |  |   |
|          |  | |         +---------+            |  |    14 |                            |  |   |
|          |  | |        /  Kitchen  \           |  |    12 |        *                   |  |   |
|          |  | |       |    45%     |           |  |    10 |  *    / \    *            |  |   |
|          |  | |  Other|            |Batterys    |  |     8 | / \  /   \  / \    *      |  |   |
|          |  | |   4%  |            |  25%      |  |     6 |/   \/     \/   \  / \     |  |   |
|          |  | |       |  Flooring  |           |  |     4 |                  \/        |  |   |
|          |  | |  HVAC |    8%      |           |  |     2 |                            |  |   |
|          |  | |  18%  +-----------+            |  |       +---+---+---+---+---+---+    |  |   |
|          |  | |                                |  |        Aug Sep Oct Nov Dec Jan     |  |   |
|          |  | | [Kitchen] [Batterys] [HVAC]     |  |                                    |  |   |
|          |  | | [Flooring] [Other]             |  | Claims ---- Avg Cost ....         |  |   |
|          |  | |                                |  |                                    |  |   |
|          |  | +--------------------------------+  +------------------------------------+  |   |
|          |  |                                                                              |   |
|          |  +------------------------------------------------------------------------------+   |
|          |                                                                                      |
|          |  +--- REVENUE VS CLAIMS COST ---------------------------------------------------+   |
|          |  |                                                                              |   |
|          |  |  Warranty Revenue vs Claims Cost - Monthly Comparison                        |   |
|          |  |                                                                              |   |
|          |  |       ^                                                                      |   |
|          |  |  $15k |  ████                                                                |   |
|          |  |       |  ████  ████                                                          |   |
|          |  |  $12k |  ████  ████  ████                                                    |   |
|          |  |       |  ████  ████  ████  ████  ████  ████                                  |   |
|          |  |   $9k |  ████  ████  ████  ████  ████  ████                                  |   |
|          |  |       |  ████  ████  ████  ████  ████  ████                                  |   |
|          |  |   $6k |  ████  ████  ████  ████  ████  ████                                  |   |
|          |  |       |  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒                                  |   |
|          |  |   $3k |  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒                                  |   |
|          |  |       |  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒  ▒▒▒▒                                  |   |
|          |  |       +--+-----+-----+-----+-----+-----+-----+                               |   |
|          |  |         Aug   Sep   Oct   Nov   Dec   Jan                                    |   |
|          |  |                                                                              |   |
|          |  |  Legend: ████ Revenue  ▒▒▒▒ Claims Cost                                      |   |
|          |  |  Net Margin: 72.4% ($9,050 of $12,500)                                       |   |
|          |  |                                                                              |   |
|          |  +------------------------------------------------------------------------------+   |
|          |                                                                                      |
+----------+-------------------------------------------------------------------------------------+
```

---

## Chart Visualizations Detail

### Claims by Product (Donut/Bar)

```
+--- DONUT CHART VIEW ------------------------+
|                                             |
|         +------------------+                |
|        /    Kitchen 45%    \               |
|       |   +------------+    |               |
|       |   |  12 claims |    | Batterys      |
|       |   +------------+    | 25%          |
|  Other|                     |               |
|   4%  |                     | HVAC         |
|       +-------- Flooring ---+ 18%          |
|                  8%                         |
|                                             |
| Hover: Kitchen - 12 claims (45%)            |
|        Avg cost: $312 per claim             |
|                                             |
+---------------------------------------------+

+--- HORIZONTAL BAR VIEW ---------------------+
|                                             |
| Kitchen    ███████████████████████  45% 12  |
| Batterys    ████████████            25%  7   |
| HVAC       █████████               18%  5   |
| Flooring   ████                     8%  2   |
| Other      ██                       4%  1   |
|                                             |
| Click bar to drill down into category       |
|                                             |
+---------------------------------------------+
```

### Claims Trend (Line Chart)

```
+--- LINE CHART WITH DUAL AXIS ---------------+
|                                             |
|     Claims Volume         Avg Cost          |
|        ^                           ^        |
|     14 |                           | $350   |
|     12 |        *                  | $300   |
|     10 |  *    / \    *           | $250   |
|      8 | / \  /   \  / \    *     | $200   |
|      6 |/   \/     \/   \  / \    | $150   |
|      4 |......................°°°.| $100   |
|      2 |      °°°°                 | $50    |
|        +---+---+---+---+---+---+           |
|         Aug Sep Oct Nov Dec Jan            |
|                                             |
| Legend:                                     |
| ─── Claims Count                            |
| ··· Average Cost per Claim                  |
|                                             |
| Hover point: November 2025                  |
|              Claims: 10, Avg Cost: $285     |
|                                             |
+---------------------------------------------+
```

### Revenue vs Cost (Stacked Bar)

```
+--- STACKED BAR CHART -----------------------+
|                                             |
|       ^                                     |
|  $15k |  ████                               |
|       |  ████  ████                         |
|  $12k |  ████  ████  ████                   |
|       |  ████  ████  ████  ████  ████ ████  |
|   $9k |  ████  ████  ████  ████  ████ ████  |
|       |  ████  ████  ████  ████  ████ ████  |
|   $6k |  ████  ████  ████  ████  ████ ████  |
|       |  ░░░░  ░░░░  ░░░░  ░░░░  ░░░░ ░░░░  |
|   $3k |  ░░░░  ░░░░  ░░░░  ░░░░  ░░░░ ░░░░  |
|       |  ░░░░  ░░░░  ░░░░  ░░░░  ░░░░ ░░░░  |
|       +--+-----+-----+-----+-----+----+     |
|         Aug   Sep   Oct   Nov   Dec  Jan    |
|                                             |
| ████ Net Revenue (after claims)             |
| ░░░░ Claims Cost                            |
|                                             |
| Hover: December 2025                        |
|        Revenue: $12,500                     |
|        Claims: $3,200                       |
|        Net: $9,300 (74%)                    |
|                                             |
+---------------------------------------------+
```

---

## Interaction States

### Loading States

```
DASHBOARD LOADING:
+---------------------------------------------------------------------+
|  Warranty Analytics                                     [Export v]   |
+---------------------------------------------------------------------+
|                                                                      |
|  +--- METRICS (Skeleton) -------------------------------------------+|
|  |                                                                  ||
|  |  +----------+  +----------+  +----------+  +----------+         ||
|  |  | [......] |  | [......] |  | [......] |  | [......] |         ||
|  |  | [......] |  | [......] |  | [......] |  | [......] |         ||
|  |  | [......] |  | [......] |  | [......] |  | [......] |         ||
|  |  +----------+  +----------+  +----------+  +----------+         ||
|  |                                                                  ||
|  +------------------------------------------------------------------+|
|                                                                      |
|  +--- CHARTS (Skeleton) -------------------------------------------+|
|  |                                                                  ||
|  |  +---------------------------+  +---------------------------+    ||
|  |  | [Shimmer animation      ] |  | [Shimmer animation      ] |    ||
|  |  | [                       ] |  | [                       ] |    ||
|  |  | [                       ] |  | [                       ] |    ||
|  |  | [                       ] |  | [                       ] |    ||
|  |  +---------------------------+  +---------------------------+    ||
|  |                                                                  ||
|  +------------------------------------------------------------------+|
|                                                                      |
+---------------------------------------------------------------------+

CHART LOADING (individual):
+---------------------------+
|  Claims by Product        |
+---------------------------+
|                           |
|   [spinner]               |
|                           |
|   Loading chart data...   |
|                           |
+---------------------------+
```

### Empty States

```
NO DATA FOR PERIOD:
+---------------------------------------------------------------------+
|  Warranty Analytics                                     [Export v]   |
+---------------------------------------------------------------------+
|  Date Range: [Last 7 days v]                                         |
+---------------------------------------------------------------------+
|                                                                      |
|  +------------------------------------------------------------------+|
|  |                                                                  ||
|  |                    +------------------+                          ||
|  |                    |   [chart icon]   |                          ||
|  |                    +------------------+                          ||
|  |                                                                  ||
|  |              No warranty data for this period                    ||
|  |                                                                  ||
|  |     No claims or warranty activity was recorded in the           ||
|  |     last 7 days. Try expanding your date range.                  ||
|  |                                                                  ||
|  |                    [Expand to 30 Days]                           ||
|  |                                                                  ||
|  +------------------------------------------------------------------+|
|                                                                      |
+---------------------------------------------------------------------+

NO CLAIMS (but warranties exist):
+---------------------------+
|  Claims by Product        |
+---------------------------+
|                           |
|       [check icon]        |
|                           |
|   No claims in period     |
|                           |
|   245 active warranties   |
|   0 claims filed          |
|                           |
+---------------------------+
```

### Error States

```
FAILED TO LOAD DASHBOARD:
+---------------------------------------------------------------------+
|  Warranty Analytics                                                  |
+---------------------------------------------------------------------+
|                                                                      |
|  +------------------------------------------------------------------+|
|  |                                                                  ||
|  |  [!] Unable to load warranty analytics                           ||
|  |                                                                  ||
|  |  There was a problem fetching the analytics data.                ||
|  |  Please try again.                                               ||
|  |                                                                  ||
|  |                        [Retry]                                   ||
|  |                                                                  ||
|  +------------------------------------------------------------------+|
|                                                                      |
+---------------------------------------------------------------------+

CHART ERROR (individual):
+---------------------------+
|  Claims Trend             |
+---------------------------+
|                           |
|  [!] Chart failed to load |
|                           |
|  [Retry]                  |
|                           |
+---------------------------+

EXPORT FAILED:
+--------------------------------------------+
|  [!] Export Failed                     [X] |
|                                            |
|  Could not generate the export file.       |
|  Please try again.                         |
|                                            |
|              [Retry Export]                |
+--------------------------------------------+
```

---

## Accessibility Notes

### Focus Order

1. **Filters Section**
   - Tab: Date range -> Category -> Comparison -> Export buttons

2. **Metric Cards**
   - Tab through each card (provides summary on focus)
   - Enter: Drill down to detailed view

3. **Charts**
   - Tab: Chart container
   - Arrow keys: Navigate between data points
   - Enter: Show tooltip/detail
   - Screen reader: Announces chart summary

### ARIA Requirements

```html
<!-- Analytics Dashboard -->
<main
  role="main"
  aria-labelledby="analytics-title"
>
  <h1 id="analytics-title">Warranty Analytics</h1>
</main>

<!-- Metric Card -->
<article
  role="region"
  aria-labelledby="metric-warranties"
  tabindex="0"
>
  <h3 id="metric-warranties">Total Warranties</h3>
  <p aria-live="polite">
    <span class="value">245</span>
    <span class="trend">+5% compared to previous period</span>
  </p>
</article>

<!-- Chart Container -->
<figure
  role="img"
  aria-labelledby="chart-claims-title"
  aria-describedby="chart-claims-desc"
  tabindex="0"
>
  <figcaption id="chart-claims-title">
    Claims by Product Category
  </figcaption>
  <p id="chart-claims-desc" class="sr-only">
    Pie chart showing claim distribution. Kitchen: 45% (12 claims),
    Batterys: 25% (7 claims), HVAC: 18% (5 claims),
    Flooring: 8% (2 claims), Other: 4% (1 claim).
  </p>
  <!-- Chart SVG with aria-hidden -->
  <svg aria-hidden="true">...</svg>
</figure>

<!-- Interactive Chart Point -->
<g
  role="button"
  tabindex="0"
  aria-label="November 2025: 10 claims, average cost $285"
>
  <circle cx="..." cy="..." />
</g>

<!-- Export Button -->
<button
  aria-label="Export warranty analytics to CSV"
>
  Export to CSV
</button>
```

### Screen Reader Announcements

- Dashboard loaded: "Warranty analytics loaded. 245 total warranties, 12 active claims, 4.9% claims rate."
- Filter applied: "Showing data for last 30 days. Kitchen category selected."
- Metric hover: "Total warranties: 245. Up 5% compared to previous period."
- Chart point: "November 2025: 10 claims filed, average cost per claim $285."
- Export started: "Generating CSV export."
- Export complete: "Export ready. Downloading warranty-analytics.csv."

---

## Animation Choreography

### Dashboard Load

```
INITIAL LOAD:
- Duration: 400ms (staggered)
- Metric cards: fade in + translateY, 50ms stagger
- Charts: fade in after metrics, 100ms delay between

SKELETON TO DATA:
- Duration: 300ms
- Skeleton: fade out
- Real data: fade in with slight scale(0.98 -> 1)
```

### Chart Animations

```
PIE/DONUT CHART:
- Duration: 800ms
- Each segment: draw from center outward
- Stagger: 50ms between segments
- Hover: segment lift with shadow

LINE CHART:
- Duration: 600ms
- Line: draw left to right
- Points: appear as line reaches them
- Hover: point scale(1.2), tooltip fade in

BAR CHART:
- Duration: 500ms
- Bars: grow from bottom
- Stagger: 30ms between bars
- Hover: bar brightness increase, label appear
```

### Filter Changes

```
FILTER APPLY:
- Duration: 300ms
- Charts: fade out (150ms) -> loading state -> fade in (150ms)
- Metrics: number count animation to new values
```

### Sparklines

```
SPARKLINE DRAW:
- Duration: 400ms
- Path: draw left to right
- Fill: fade in after path complete
- Trend indicator: bounce in at end
```

---

## Component Props Interface

```typescript
// Main Analytics Dashboard
interface WarrantyAnalyticsDashboardProps {
  initialFilters?: AnalyticsFilters;
}

interface AnalyticsFilters {
  dateRange: 'last7' | 'last30' | 'last90' | 'thisYear' | 'custom';
  customDateFrom?: Date;
  customDateTo?: Date;
  categoryId?: string;
  comparisonPeriod?: 'previous' | 'lastYear' | 'none';
}

// Analytics Data Types
interface WarrantyAnalyticsData {
  summary: AnalyticsSummary;
  claimsByCategory: CategoryClaimsData[];
  claimsTrend: TrendDataPoint[];
  revenueVsCost: RevenueDataPoint[];
  comparisonData?: ComparisonData;
}

interface AnalyticsSummary {
  totalWarranties: number;
  warrantiesChange: number;
  activeClaims: number;
  claimsChange: number;
  claimsRate: number;
  claimsRateChange: number;
  avgClaimCost: number;
  avgCostChange: number;
  totalClaimsCost: number;
  totalCostChange: number;
  warrantyRevenue: number;
  revenueChange: number;
}

interface CategoryClaimsData {
  categoryId: string;
  categoryName: string;
  claimsCount: number;
  percentage: number;
  avgCost: number;
  totalCost: number;
}

interface TrendDataPoint {
  month: string;
  date: Date;
  claimsCount: number;
  avgCost: number;
  totalCost: number;
}

interface RevenueDataPoint {
  month: string;
  date: Date;
  revenue: number;
  claimsCost: number;
  netMargin: number;
  marginPercent: number;
}

// Metric Card Component
interface MetricCardProps {
  title: string;
  value: number | string;
  format?: 'number' | 'currency' | 'percent';
  change?: number;
  changeLabel?: string;
  sparklineData?: number[];
  onClick?: () => void;
}

// Chart Components
interface ClaimsByCategoryChartProps {
  data: CategoryClaimsData[];
  chartType: 'donut' | 'bar';
  onCategoryClick?: (categoryId: string) => void;
  isLoading: boolean;
}

interface ClaimsTrendChartProps {
  data: TrendDataPoint[];
  showAvgCost?: boolean;
  isLoading: boolean;
  onPointClick?: (point: TrendDataPoint) => void;
}

interface RevenueVsCostChartProps {
  data: RevenueDataPoint[];
  isLoading: boolean;
  showNetMargin?: boolean;
}

// Export Component
interface AnalyticsExportProps {
  filters: AnalyticsFilters;
  format: 'csv' | 'pdf';
  onExportStart: () => void;
  onExportComplete: (url: string) => void;
  onExportError: (error: Error) => void;
}

// Hook for Analytics Data
interface UseWarrantyAnalyticsOptions {
  filters: AnalyticsFilters;
}

interface UseWarrantyAnalyticsReturn {
  data: WarrantyAnalyticsData | null;
  isLoading: boolean;
  error: Error | null;
  refetch: () => Promise<void>;
}
```

---

## Responsive Behavior

| Breakpoint | Layout | Charts |
|------------|--------|--------|
| Mobile (<768px) | Single column, stacked | Simplified, touch-friendly |
| Tablet (768-1024px) | 2-column grid | Full charts, smaller |
| Desktop (>1024px) | Multi-column dashboard | Full-size charts with hover |

### Mobile-Specific Behavior

- Metric cards in scrollable row
- Charts stack vertically
- Touch gestures for chart interaction
- Simplified chart legends
- Bottom sheet for filters

### Desktop-Specific Behavior

- All metrics visible without scroll
- Hover states on chart elements
- Inline tooltips
- Keyboard navigation for charts
- Side-by-side chart comparison

---

## Component Files

| File | Purpose |
|------|---------|
| `src/routes/reports/warranties.tsx` | Analytics page route (modify) |
| `src/components/domain/support/warranty-analytics-charts.tsx` | Chart wrapper component |
| `src/components/domain/reports/metric-card.tsx` | Summary metric cards |
| `src/components/domain/charts/claims-by-category-chart.tsx` | Pie/bar chart |
| `src/components/domain/charts/claims-trend-chart.tsx` | Line chart |
| `src/components/domain/charts/revenue-vs-cost-chart.tsx` | Stacked bar |
| `src/components/domain/charts/sparkline.tsx` | Inline sparkline |
| `src/server/functions/warranty-analytics.ts` | Analytics data fetching |
| `src/hooks/use-warranty-analytics.ts` | Analytics hook |

---

**Document Version:** 1.0
**Created:** 2026-01-10
**Story Reference:** DOM-WAR-008
