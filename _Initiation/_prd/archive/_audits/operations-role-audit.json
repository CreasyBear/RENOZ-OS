{
  "role": "operations",
  "audit_date": "2026-01-09",
  "prd_file": "memory-bank/prd/roles/operations.prd.json",
  "persona": "Operations / Warehouse",
  "implementation_percentage": 25,
  "summary": "Operations role has foundational infrastructure but lacks dedicated role-specific views. Core fulfillment components exist (fulfillment-tab, serial-picker, pick list PDF, packing slip PDF) but need a dedicated operations dashboard and streamlined workflows. Strong dependency on domain PRDs (orders, inventory) for several stories.",
  "existing_implementation": {
    "dashboard_widgets": [
      {
        "name": "todays-shipments-widget.tsx",
        "location": "src/components/domain/dashboard/widgets/",
        "description": "Shows Ready to Pick, Ready to Ship, Shipped Today counts with 1-click navigation"
      },
      {
        "name": "low-stock-widget.tsx",
        "location": "src/components/domain/dashboard/widgets/",
        "description": "Displays products below reorder point with severity badges"
      }
    ],
    "role_defaults": {
      "file": "src/components/domain/dashboard/role-defaults.ts",
      "warehouse_widgets": [
        "quick-todays-shipments",
        "kpi-orders",
        "chart-orders-status",
        "chart-inventory-levels",
        "table-recent-orders",
        "table-low-stock"
      ]
    },
    "fulfillment_components": [
      {
        "name": "fulfillment-tab.tsx",
        "path": "src/components/domain/orders/fulfillment-tab.tsx",
        "features": [
          "Stock allocation with auto-allocate (FIFO)",
          "Manual serial selection",
          "Pick list with location/serial display",
          "Swipeable row for pick confirmation",
          "Short pick reporting"
        ]
      },
      {
        "name": "fulfillment-actions.tsx",
        "path": "src/components/domain/orders/fulfillment-actions.tsx",
        "features": [
          "Allocate Stock button",
          "Start Picking action",
          "Mark Ready to Ship action",
          "Ship Order dialog with carrier/tracking",
          "Edit shipping details (within 24h)"
        ]
      },
      {
        "name": "serial-picker.tsx",
        "path": "src/components/domain/orders/serial-picker.tsx",
        "features": ["Manual serial number selection for order items"]
      },
      {
        "name": "short-pick-dialog.tsx",
        "path": "src/components/domain/orders/short-pick-dialog.tsx",
        "features": ["Report shortage with reason, quantity available, notes"]
      },
      {
        "name": "batch-pick-dialog.tsx",
        "path": "src/components/domain/orders/batch-pick-dialog.tsx",
        "features": ["Select multiple orders for batch picking"]
      },
      {
        "name": "pick-list-pdf.tsx",
        "path": "src/components/domain/orders/pick-list-pdf.tsx",
        "features": ["Print-ready pick list PDF generation"]
      },
      {
        "name": "packing-slip-pdf.tsx",
        "path": "src/components/domain/orders/packing-slip-pdf.tsx",
        "features": ["Print-ready packing slip PDF generation"]
      }
    ],
    "receiving_components": [
      {
        "name": "receive-goods.tsx",
        "path": "src/components/domain/procurement/receive-goods.tsx",
        "features": [
          "Receive items from PO",
          "Partial receipts",
          "Qty received/rejected entry",
          "Serial number entry for serialized items",
          "Bin location entry",
          "Quick receive all action"
        ]
      }
    ],
    "routes": [
      {
        "path": "/orders",
        "has_status_filters": true,
        "supports_warehouse_filtering": true
      },
      {
        "path": "/inventory",
        "description": "Basic inventory list with stock status filters"
      },
      {
        "path": "/catalog",
        "description": "Product catalog with low stock filtering"
      },
      {
        "path": "/procurement/purchase-orders",
        "description": "PO list with receiving capability"
      }
    ],
    "server_functions": [
      "allocateStock - FIFO allocation to order items",
      "deallocateStock - Release allocated stock",
      "shipOrder - Mark as shipped with carrier/tracking",
      "updateShippingDetails - Edit shipping info",
      "reportShortPick - Record picking shortage"
    ]
  },
  "story_audit": [
    {
      "id": "ROLE-OPS-001",
      "name": "Warehouse Dashboard",
      "status": "partially_exists",
      "estimated_iterations": 3,
      "adjusted_from": 5,
      "validation_notes": [
        "role-defaults.ts already configures warehouse role with appropriate widgets",
        "todays-shipments-widget.tsx provides fulfillment status counts",
        "low-stock-widget.tsx shows below-reorder products",
        "MISSING: Dedicated /operations or /warehouse route as default landing",
        "MISSING: Awaiting receipts widget (expected PO deliveries)",
        "MISSING: Quick action buttons (start picking, receive goods)",
        "MISSING: Real-time stock summary widget (not just low stock)"
      ],
      "dependencies": [],
      "dependencies_status": "clear",
      "crosses_layers": false,
      "ralph_ready": true,
      "blockers": [],
      "files_to_create": [
        "src/routes/operations/index.tsx",
        "src/components/domain/dashboard/widgets/awaiting-receipts-widget.tsx",
        "src/components/domain/dashboard/widgets/quick-actions-widget.tsx",
        "src/components/domain/dashboard/widgets/stock-summary-widget.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-002",
      "name": "Streamlined Picking Workflow",
      "status": "partially_exists",
      "estimated_iterations": 2,
      "adjusted_from": 4,
      "validation_notes": [
        "fulfillment-tab.tsx already has pick list with locations and serials",
        "SwipeableRow component enables swipe-to-pick gesture",
        "Short pick dialog exists for shortage handling",
        "MISSING: Dedicated pick queue view (orders ready to pick)",
        "MISSING: Mobile-optimized standalone picking route",
        "MISSING: Progress tracking during picking session",
        "EXISTING: pick-list-pdf.tsx for printable pick lists"
      ],
      "dependencies": [],
      "dependencies_status": "clear",
      "crosses_layers": false,
      "ralph_ready": true,
      "blockers": [],
      "files_to_create": [
        "src/routes/operations/picking/index.tsx",
        "src/routes/operations/picking/$orderId.tsx",
        "src/components/domain/operations/pick-queue.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-003",
      "name": "Batch Picking for Multiple Orders",
      "status": "partially_exists",
      "estimated_iterations": 3,
      "adjusted_from": 4,
      "validation_notes": [
        "batch-pick-dialog.tsx exists for selecting multiple orders",
        "MISSING: Consolidated pick list by product",
        "MISSING: Show which orders need each item",
        "MISSING: Distribute picked items to orders workflow",
        "MISSING: Mixed fulfillment handling (some complete, some partial)"
      ],
      "dependencies": ["ROLE-OPS-002"],
      "dependencies_status": "requires_ROLE-OPS-002",
      "crosses_layers": false,
      "ralph_ready": true,
      "blockers": [],
      "files_to_create": [
        "src/components/domain/operations/batch-pick-list.tsx",
        "src/components/domain/operations/distribute-picks-dialog.tsx",
        "src/routes/operations/picking/batch.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-004",
      "name": "Low-Stock Alert System",
      "status": "partially_exists",
      "estimated_iterations": 3,
      "adjusted_from": 4,
      "validation_notes": [
        "low-stock-widget.tsx shows items below reorder point",
        "products.reorderPoint column EXISTS in schema",
        "Low stock filtering in /catalog route EXISTS",
        "MISSING: Alert badge on nav when low stock exists",
        "MISSING: One-click PO creation from alert",
        "MISSING: Configure thresholds per product (partially exists)",
        "DEPENDENCY: DOM-INV-001 may add additional reorder point features"
      ],
      "dependencies": ["DOM-INV-001"],
      "dependencies_status": "requires_DOM-INV-001",
      "crosses_layers": true,
      "layer_cross_analysis": "DOM-INV-001 adds reorderPoint/reorderQty columns which may already exist. Need to verify schema before implementing. Alert features are presentation layer only.",
      "ralph_ready": false,
      "blockers": [
        "Verify if DOM-INV-001 schema changes already exist",
        "DOM-INV-001 notification trigger logic needed"
      ],
      "files_to_create": [
        "src/components/domain/operations/low-stock-alert-badge.tsx",
        "src/components/domain/operations/create-po-from-alert-dialog.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-005",
      "name": "Quick Receiving Flow",
      "status": "exists",
      "estimated_iterations": 2,
      "adjusted_from": 4,
      "validation_notes": [
        "receive-goods.tsx EXISTS with full functionality",
        "Handles partial receipts with qty tracking",
        "Auto-match to PO line items implemented",
        "Serial number entry for serialized items",
        "Bin location entry at receive time",
        "MISSING: Expected receipts list/dashboard widget",
        "MISSING: Print GRN (Goods Received Note)",
        "MISSING: Putaway confirmation step (separate from receiving)"
      ],
      "dependencies": [],
      "dependencies_status": "clear",
      "crosses_layers": false,
      "ralph_ready": true,
      "blockers": [],
      "files_to_create": [
        "src/routes/operations/receiving/index.tsx",
        "src/components/domain/operations/expected-receipts-list.tsx",
        "src/components/domain/procurement/grn-pdf.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-006",
      "name": "Shipment Coordination View",
      "status": "not_started",
      "estimated_iterations": 5,
      "adjusted_from": 4,
      "validation_notes": [
        "todays-shipments-widget provides basic counts",
        "fulfillment-actions.tsx has ship order dialog",
        "MISSING: Shipment queue by status",
        "MISSING: Carrier assignment and tracking entry (basic exists in ship dialog)",
        "MISSING: Expected delivery dates",
        "MISSING: Print shipping labels (future carrier integration)",
        "MISSING: Bulk shipment actions",
        "DEPENDENCY: DOM-ORD-003 adds partial shipment tracking which this view needs"
      ],
      "dependencies": ["DOM-ORD-003"],
      "dependencies_status": "blocked_by_DOM-ORD-003",
      "crosses_layers": true,
      "layer_cross_analysis": "DOM-ORD-003 creates order_shipments table and shipmentItems table for tracking. ROLE-OPS-006 is purely UI on top of that schema. Must wait for DOM-ORD-003a, DOM-ORD-003b to be complete.",
      "ralph_ready": false,
      "blockers": [
        "DOM-ORD-003a: Partial Shipments Schema required",
        "DOM-ORD-003b: Partial Shipments Server Functions required"
      ],
      "files_to_create": [
        "src/routes/operations/shipments/index.tsx",
        "src/components/domain/operations/shipment-queue.tsx",
        "src/components/domain/operations/bulk-shipment-actions.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-007",
      "name": "Real-time Stock on Order Screen",
      "status": "partially_exists",
      "estimated_iterations": 2,
      "adjusted_from": 3,
      "validation_notes": [
        "fulfillment-tab.tsx shows allocation status per item",
        "Stock available vs allocated is calculated during allocation",
        "MISSING: Live stock display (Available vs Allocated vs Total) on order detail",
        "MISSING: Out of stock highlighting",
        "MISSING: Quick link to inventory detail",
        "MISSING: Inline stock check without leaving order"
      ],
      "dependencies": [],
      "dependencies_status": "clear",
      "crosses_layers": false,
      "ralph_ready": true,
      "blockers": [],
      "files_to_create": [
        "src/components/domain/orders/stock-availability-indicator.tsx"
      ],
      "files_to_modify": [
        "src/components/domain/orders/items-tab.tsx"
      ]
    },
    {
      "id": "ROLE-OPS-008",
      "name": "Mobile-Optimized Warehouse Views",
      "status": "not_started",
      "estimated_iterations": 5,
      "adjusted_from": 5,
      "validation_notes": [
        "SwipeableRow component exists for mobile gestures",
        "MISSING: Responsive mobile layout for picking workflow",
        "MISSING: Large touch targets for actions",
        "MISSING: Barcode scanning support (camera)",
        "MISSING: Tablet optimization",
        "MISSING: Offline-tolerant for poor connectivity (PWA/service worker)",
        "High complexity due to camera integration and offline support"
      ],
      "dependencies": ["ROLE-OPS-002"],
      "dependencies_status": "requires_ROLE-OPS-002",
      "crosses_layers": true,
      "layer_cross_analysis": "Mobile optimization is cross-cutting. Barcode scanning requires browser camera APIs. Offline support requires service workers and local storage. Consider breaking into sub-stories.",
      "ralph_ready": false,
      "blockers": [
        "ROLE-OPS-002 picking workflow must be complete first",
        "Camera API integration for barcode scanning is complex",
        "Offline support requires significant architecture work"
      ],
      "files_to_create": [
        "src/components/domain/operations/mobile-pick-view.tsx",
        "src/components/shared/barcode-scanner.tsx",
        "src/hooks/use-barcode-scanner.ts",
        "public/service-worker.js"
      ],
      "suggested_sub_stories": [
        "ROLE-OPS-008a: Responsive mobile layouts (2 iterations)",
        "ROLE-OPS-008b: Touch optimization and large targets (1 iteration)",
        "ROLE-OPS-008c: Barcode scanning integration (3 iterations)",
        "ROLE-OPS-008d: Offline support with service worker (4 iterations)"
      ]
    }
  ],
  "total_estimated_iterations": 25,
  "original_prd_estimate": 33,
  "efficiency_gain": "24% reduction due to existing infrastructure",
  "critical_path": [
    {
      "phase": 1,
      "stories": ["ROLE-OPS-001", "ROLE-OPS-002", "ROLE-OPS-005", "ROLE-OPS-007"],
      "iterations": 9,
      "description": "Foundation: Dashboard, picking flow, receiving, stock display - no blockers"
    },
    {
      "phase": 2,
      "stories": ["ROLE-OPS-003", "ROLE-OPS-004"],
      "iterations": 6,
      "description": "Enhancement: Batch picking (requires 002), alerts (requires DOM-INV-001 verification)"
    },
    {
      "phase": 3,
      "stories": ["ROLE-OPS-006"],
      "iterations": 5,
      "description": "Shipment view - blocked by DOM-ORD-003"
    },
    {
      "phase": 4,
      "stories": ["ROLE-OPS-008"],
      "iterations": 5,
      "description": "Mobile optimization - complex, consider splitting"
    }
  ],
  "domain_dependencies": {
    "DOM-INV-001": {
      "status": "pending",
      "required_by": ["ROLE-OPS-004"],
      "features_needed": ["reorder point columns", "low stock notification trigger"]
    },
    "DOM-ORD-003": {
      "status": "pending",
      "required_by": ["ROLE-OPS-006"],
      "features_needed": ["order_shipments table", "shipmentItems table", "partial shipment tracking"]
    }
  },
  "recommendations": [
    {
      "priority": "high",
      "recommendation": "Start with ROLE-OPS-001 (dashboard) and ROLE-OPS-002 (picking) as they have no blockers and provide immediate value to operations team"
    },
    {
      "priority": "high",
      "recommendation": "Verify if products.reorderPoint already exists in schema before waiting on DOM-INV-001 - low-stock-widget.tsx already uses it"
    },
    {
      "priority": "medium",
      "recommendation": "ROLE-OPS-005 (receiving) is 80% complete - focus on GRN PDF and expected receipts list only"
    },
    {
      "priority": "medium",
      "recommendation": "Split ROLE-OPS-008 (mobile) into sub-stories - barcode scanning and offline support are separate concerns with high complexity"
    },
    {
      "priority": "low",
      "recommendation": "Coordinate with DOM-ORD-003 (partial shipments) implementation timing before starting ROLE-OPS-006"
    }
  ],
  "stories_ready_for_ralph": [
    "ROLE-OPS-001: Warehouse Dashboard (3 iterations)",
    "ROLE-OPS-002: Streamlined Picking Workflow (2 iterations)",
    "ROLE-OPS-005: Quick Receiving Flow (2 iterations)",
    "ROLE-OPS-007: Real-time Stock on Order Screen (2 iterations)"
  ],
  "stories_blocked": [
    "ROLE-OPS-004: Low-Stock Alert System - verify DOM-INV-001 status",
    "ROLE-OPS-006: Shipment Coordination View - blocked by DOM-ORD-003",
    "ROLE-OPS-008: Mobile-Optimized Warehouse Views - requires ROLE-OPS-002 + complex scope"
  ]
}
