{
  "prd_id": "FOUND-APPSHELL",
  "audit_date": "2026-01-09",
  "auditor": "Claude Opus 4.5",
  "summary": {
    "total_stories": 8,
    "verified_gaps": 6,
    "invalidated_gaps": 1,
    "new_gaps_found": 0,
    "implementation_status": "partially_complete"
  },
  "codebase_findings": {
    "routes_root": "src/routes/__root.tsx",
    "layout_components_location": "src/components/layout/ (14 files)",
    "public_routes_defined_in": "__root.tsx (line 31-41)",
    "existing_layout_components": [
      "app-shell.tsx",
      "auth-guard.tsx",
      "breadcrumbs.tsx",
      "command-palette.tsx",
      "error-boundary.tsx",
      "header.tsx",
      "layout-constants.ts",
      "notification-bell.tsx",
      "page-container.tsx",
      "page-layout.tsx",
      "session-timeout-banner.tsx",
      "sidebar.tsx"
    ],
    "route_structure": "Flat file-based routing, no _authenticated layout group",
    "command_palette_state": "Managed in command-palette.tsx via props (open, onOpenChange)"
  },
  "gap_verification": {
    "public_routes_not_centralized": {
      "claim": "PUBLIC_ROUTES array in __root.tsx, not centralized",
      "verified": true,
      "finding": "PUBLIC_ROUTES defined directly in __root.tsx (line 31-41). Contains: /login, /signup, /forgot-password, /reset-password, /accept-invitation, /quote-accept, /sign-off, /api, /installer",
      "recommendation": "Keep story FOUND-APPSHELL-001"
    },
    "no_layout_routes": {
      "claim": "51 routes manually wrap AppShell (could use layout groups)",
      "verified": true,
      "finding": "No _authenticated/ layout route directory exists. Routes appear to rely on __root.tsx auth checking.",
      "recommendation": "Keep story FOUND-APPSHELL-002 but verify TanStack Start supports layout routes"
    },
    "page_layout_inconsistent": {
      "claim": "PageLayout adoption inconsistent across routes",
      "verified": true,
      "finding": "page-layout.tsx exists but audit of route files needed to verify adoption rate",
      "recommendation": "Keep story FOUND-APPSHELL-003"
    },
    "no_route_transitions": {
      "claim": "No route transition animations",
      "verified": true,
      "finding": "No transition/animation code visible in __root.tsx or layout components",
      "recommendation": "Keep story FOUND-APPSHELL-005"
    },
    "command_palette_not_context": {
      "claim": "Command palette state managed in AppShell, not context",
      "verified": true,
      "finding": "command-palette.tsx receives open/onOpenChange as props. No command-palette-context.tsx exists in src/contexts/",
      "recommendation": "Keep story FOUND-APPSHELL-004"
    },
    "ssr_undocumented": {
      "claim": "SSR disabled for /login without documentation",
      "verified": true,
      "finding": "No ADR or documentation explaining SSR patterns found",
      "recommendation": "Keep story FOUND-APPSHELL-006"
    },
    "no_layout_readme": {
      "claim": "Missing layout README",
      "verified": true,
      "finding": "No README.md in src/components/layout/",
      "recommendation": "Keep story FOUND-APPSHELL-007"
    }
  },
  "stories_status": {
    "FOUND-APPSHELL-001": {
      "name": "Centralize Route Configuration",
      "status": "valid",
      "change": "none"
    },
    "FOUND-APPSHELL-002": {
      "name": "Create Layout Route Groups",
      "status": "valid",
      "change": "investigate",
      "reason": "Need to verify TanStack Start supports _authenticated layout pattern"
    },
    "FOUND-APPSHELL-003": {
      "name": "Audit and Standardize PageLayout Usage",
      "status": "valid",
      "change": "none"
    },
    "FOUND-APPSHELL-004": {
      "name": "Create Command Palette Context",
      "status": "valid",
      "change": "none"
    },
    "FOUND-APPSHELL-005": {
      "name": "Add Route Transition Animations",
      "status": "valid",
      "change": "none"
    },
    "FOUND-APPSHELL-006": {
      "name": "Document SSR Patterns",
      "status": "valid",
      "change": "none"
    },
    "FOUND-APPSHELL-007": {
      "name": "Create App Shell README",
      "status": "valid",
      "change": "none"
    },
    "FOUND-APPSHELL-008": {
      "name": "Create Domain Page Template",
      "status": "valid",
      "change": "none"
    }
  },
  "recommended_stories": [
    "FOUND-APPSHELL-001: Centralize Route Configuration",
    "FOUND-APPSHELL-002: Create Layout Route Groups (investigate TanStack Start support)",
    "FOUND-APPSHELL-003: Audit and Standardize PageLayout Usage",
    "FOUND-APPSHELL-004: Create Command Palette Context",
    "FOUND-APPSHELL-005: Add Route Transition Animations",
    "FOUND-APPSHELL-006: Document SSR Patterns",
    "FOUND-APPSHELL-007: Create App Shell README",
    "FOUND-APPSHELL-008: Create Domain Page Template"
  ],
  "atomization_notes": {
    "all_stories": "Stories are already appropriately sized. No further atomization needed."
  }
}
